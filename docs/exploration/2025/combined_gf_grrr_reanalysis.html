<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>12&nbsp; Combined Google-GloFAS trigger - reanalysis – Anticipatory Action - Nigeria Flooding</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../exploration/2025/gf_reforecast.html" rel="next">
<link href="../../exploration/2025/floodscan_verify.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-01c78b5cd655e4cd89133cf59d535862.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-7580570a2e354cd56757c689413fca0c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>


<link rel="stylesheet" href="../../quarto_assets/custom.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../exploration/2025/combined_gf_grrr_reanalysis.html">Trigger setting</a></li><li class="breadcrumb-item"><a href="../../exploration/2025/combined_gf_grrr_reanalysis.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Combined Google-GloFAS trigger - reanalysis</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../quarto_assets/images/centre_banner_greenbg.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Anticipatory Action - Nigeria Flooding</a>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container">
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container">
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container">
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Targeting</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a>
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
          <li class="sidebar-item">
  <div class="sidebar-item-container">
  <a href="../../exploration/2025/impact_comparison.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Impact comparison</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container">
  <a href="../../exploration/2025/nhf_targeting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Targerted LGAs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container">
  <a href="../../exploration/2025/adamawa_lgas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Adamawa LGAs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container">
  <a href="../../exploration/2025/benue_buffer_exposure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Benue buffer exposure</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container">
  <a href="../../exploration/2025/flood_risk_exposure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Flood risk exposure</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container">
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">GloFAS processing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a>
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
          <li class="sidebar-item">
  <div class="sidebar-item-container">
  <a href="../../exploration/2025/glofas_new_reanalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">GloFAS new reanalysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container">
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Google processing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a>
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
          <li class="sidebar-item">
  <div class="sidebar-item-container">
  <a href="../../exploration/2025/grrr_comparison.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">GloFAS vs Google Reanalysis Comparison</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container">
  <a href="../../exploration/2025/grrr_explore.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">GRRR Forecast Skill and NiHSA Comparison</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container">
  <a href="../../exploration/2025/grrr_inundation_history.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Exploring Google’s Inundation History products</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container">
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Floodscan processing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a>
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
          <li class="sidebar-item">
  <div class="sidebar-item-container">
  <a href="../../exploration/2025/fs_pixels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Floodscan pixels</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container">
  <a href="../../exploration/2025/floodscan_verify.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Verifying Floodscan data with NiHSA observations</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container">
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Trigger setting</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a>
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
          <li class="sidebar-item">
  <div class="sidebar-item-container">
  <a href="../../exploration/2025/combined_gf_grrr_reanalysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Combined Google-GloFAS trigger - reanalysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container">
  <a href="../../exploration/2025/gf_reforecast.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">GloFAS reforecast threshold check</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container">
  <a href="../../exploration/2025/grrr_forecast.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Google forecast</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container">
  <a href="../../exploration/2025/plot_trigger_years.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Trigger plots</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>

  <ul>
  <li><a href="#load-data" id="toc-load-data" class="nav-link active" data-scroll-target="#load-data"><span class="header-section-number">12.1</span> Load data</a>
  <ul class="collapse">
  <li><a href="#glofas" id="toc-glofas" class="nav-link" data-scroll-target="#glofas"><span class="header-section-number">12.1.1</span> GloFAS</a></li>
  <li><a href="#floodscan" id="toc-floodscan" class="nav-link" data-scroll-target="#floodscan"><span class="header-section-number">12.1.2</span> Floodscan</a></li>
  <li><a href="#google" id="toc-google" class="nav-link" data-scroll-target="#google"><span class="header-section-number">12.1.3</span> Google</a></li>
  </ul></li>
  <li><a href="#process" id="toc-process" class="nav-link" data-scroll-target="#process"><span class="header-section-number">12.2</span> Process</a>
  <ul class="collapse">
  <li><a href="#iterate" id="toc-iterate" class="nav-link" data-scroll-target="#iterate"><span class="header-section-number">12.2.1</span> Iterate</a></li>
  </ul></li>
  <li><a href="#plots" id="toc-plots" class="nav-link" data-scroll-target="#plots"><span class="header-section-number">12.3</span> Plots</a>
  <ul class="collapse">
  <li><a href="#specific-overall-rp" id="toc-specific-overall-rp" class="nav-link" data-scroll-target="#specific-overall-rp"><span class="header-section-number">12.3.1</span> Specific overall RP</a></li>
  </ul></li>
  <li><a href="#specific-combination" id="toc-specific-combination" class="nav-link" data-scroll-target="#specific-combination"><span class="header-section-number">12.4</span> Specific combination</a>
  <ul class="collapse">
  <li><a href="#true-positives" id="toc-true-positives" class="nav-link" data-scroll-target="#true-positives"><span class="header-section-number">12.4.1</span> True positives</a></li>
  <li><a href="#false-positives" id="toc-false-positives" class="nav-link" data-scroll-target="#false-positives"><span class="header-section-number">12.4.2</span> False positives</a></li>
  <li><a href="#false-negatives" id="toc-false-negatives" class="nav-link" data-scroll-target="#false-negatives"><span class="header-section-number">12.4.3</span> False negatives</a></li>
  <li><a href="#true-negatives" id="toc-true-negatives" class="nav-link" data-scroll-target="#true-negatives"><span class="header-section-number">12.4.4</span> True negatives</a></li>
  <li><a href="#timeline" id="toc-timeline" class="nav-link" data-scroll-target="#timeline"><span class="header-section-number">12.4.5</span> Timeline</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../exploration/2025/combined_gf_grrr_reanalysis.html">Trigger setting</a></li><li class="breadcrumb-item"><a href="../../exploration/2025/combined_gf_grrr_reanalysis.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Combined Google-GloFAS trigger - reanalysis</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Combined Google-GloFAS trigger - reanalysis</span></h1>
</div>



<div class="quarto-title-meta">




  </div>



</header>


<!-- markdownlint-disable MD013 -->
<p>Determine best balance of Google and GloFAS forecasts to maximize accuracy and leadtime.</p>
<p>For simplicity, just doing now with reanalysis. Later notebooks use the reanalysis-based thresholds and see how many leadtimes we can add before the accuracy drops off.</p>
<div id="8769ca6a-ce1f-42b8-9db1-8900886ac0fa" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>load_ext jupyter_black</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>load_ext autoreload</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>autoreload <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

                <script type="application/javascript" id="jupyter_black">
                (function() {
                    if (window.IPython === undefined) {
                        return
                    }
                    var msg = "WARNING: it looks like you might have loaded " +
                        "jupyter_black in a non-lab notebook with " +
                        "`is_lab=True`. Please double check, and if " +
                        "loading with `%load_ext` please review the README!"
                    console.log(msg)
                    alert(msg)
                })()
                </script>

</div>
</div>
<div id="6a09be06-71ba-4141-8a1f-83d243287bf8" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ocha_stratus <span class="im">as</span> stratus</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.dates <span class="im">as</span> mdates</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm.auto <span class="im">import</span> tqdm</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> src.datasources <span class="im">import</span> glofas, grrr</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> src.constants <span class="im">import</span> <span class="op">*</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> src.utils <span class="im">import</span> rp_calc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="load-data" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="load-data"><span class="header-section-number">12.1</span> Load data</h2>
<section id="glofas" class="level3" data-number="12.1.1">
<h3 data-number="12.1.1" class="anchored" data-anchor-id="glofas"><span class="header-section-number">12.1.1</span> GloFAS</h3>
<div id="34a26e9a-9e7a-4dcf-8e5b-46cee21988ad" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df_gf <span class="op">=</span> glofas.load_glofas_reanalysis(station_name<span class="op">=</span><span class="st">"wuroboki"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="d003a4bc-37ad-4149-b55a-efea767e31f3" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df_gf <span class="op">=</span> df_gf.rename(columns<span class="op">=</span>{<span class="st">"time"</span>: <span class="st">"valid_time"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="floodscan" class="level3" data-number="12.1.2">
<h3 data-number="12.1.2" class="anchored" data-anchor-id="floodscan"><span class="header-section-number">12.1.2</span> Floodscan</h3>
<div id="8d5494bc-a413-48ac-955b-edc43844a3ff" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df_fs_raw <span class="op">=</span> stratus.load_parquet_from_blob(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"</span><span class="sc">{</span>PROJECT_PREFIX<span class="sc">}</span><span class="ss">/processed/floodscan/fs_benue_pixels_1998_2024.parquet"</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>df_fs <span class="op">=</span> (</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    df_fs_raw.groupby(<span class="st">"date"</span>)[<span class="st">"SFED"</span>]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    .mean()</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">"date"</span>: <span class="st">"valid_time"</span>})</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="google" class="level3" data-number="12.1.3">
<h3 data-number="12.1.3" class="anchored" data-anchor-id="google"><span class="header-section-number">12.1.3</span> Google</h3>
<div id="0ca47e39-f01c-4038-b417-faaf73b3ec23" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ds_ra <span class="op">=</span> grrr.load_reanalysis()</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>df_grrr <span class="op">=</span> grrr.process_reanalysis(ds_ra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="process" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="process"><span class="header-section-number">12.2</span> Process</h2>
<div id="5c2eb020-e032-4d58-be74-c7488dff4112" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df_compare <span class="op">=</span> df_gf.merge(df_fs).merge(df_grrr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="d1869267-a4e6-41e8-ae7c-723c908ebeda" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df_compare[<span class="st">"year"</span>] <span class="op">=</span> df_compare[<span class="st">"valid_time"</span>].dt.year</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="ea787a85-78ef-43e7-9807-ce0cca4ddc78" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df_yearly_max <span class="op">=</span> (</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    df_compare.groupby(<span class="st">"year"</span>).<span class="bu">max</span>().drop(columns<span class="op">=</span>[<span class="st">"valid_time"</span>]).reset_index()</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Determine dates of peak for each indicator.</p>
<div id="249a27e6-99b7-42af-aa03-c0753036c347" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> [<span class="st">"dis24"</span>, <span class="st">"SFED"</span>, <span class="st">"streamflow"</span>]:</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    df_yearly_max[<span class="ss">f"</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">_maxdate"</span>] <span class="op">=</span> df_compare.loc[</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        df_compare.groupby(<span class="st">"year"</span>).idxmax()[col]</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    ][<span class="st">"valid_time"</span>].values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Leadtime between peaks.</p>
<div id="326c517a-189a-426b-a596-38efaaf98b79" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> [<span class="st">"dis24"</span>, <span class="st">"streamflow"</span>]:</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    df_yearly_max[<span class="ss">f"</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">_peak_leadtime"</span>] <span class="op">=</span> (</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>        df_yearly_max[<span class="st">"SFED_maxdate"</span>] <span class="op">-</span> df_yearly_max[<span class="ss">f"</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">_maxdate"</span>]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Return periods.</p>
<div id="c68c668c-7a5e-41d2-a93c-db92fd44bffc" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> [<span class="st">"dis24"</span>, <span class="st">"SFED"</span>, <span class="st">"streamflow"</span>]:</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    df_yearly_max <span class="op">=</span> rp_calc.calculate_one_group_rp(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>        df_yearly_max, col_name<span class="op">=</span>col, ascending<span class="op">=</span><span class="va">False</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Set whether to target each year, depending on return period severity.</p>
<p>This is admittedly not the best way to do this (would be easier filtering by ranks later), but will leave it for now because the rest of the code was already set up for this format.</p>
<div id="51b41c00-06ff-44c6-b0de-ac5cba86704d" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>rp_targets <span class="op">=</span> [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="8baa11f2-81c0-4e10-a3ca-fefba7ac4808" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> rp_target <span class="kw">in</span> rp_targets:</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    df_yearly_max[<span class="ss">f"</span><span class="sc">{</span>rp_target<span class="sc">}</span><span class="ss">yr_target"</span>] <span class="op">=</span> (</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>        df_yearly_max[<span class="st">"SFED_rp"</span>] <span class="op">&gt;=</span> rp_target</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="0a413c7f-ce5e-4bff-b81b-bf24e2da43af" class="cell" data-execution_count="19">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df_yearly_max</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">dis24</th>
<th data-quarto-table-cell-role="th">SFED</th>
<th data-quarto-table-cell-role="th">streamflow</th>
<th data-quarto-table-cell-role="th">dis24_maxdate</th>
<th data-quarto-table-cell-role="th">SFED_maxdate</th>
<th data-quarto-table-cell-role="th">streamflow_maxdate</th>
<th data-quarto-table-cell-role="th">dis24_peak_leadtime</th>
<th data-quarto-table-cell-role="th">streamflow_peak_leadtime</th>
<th data-quarto-table-cell-role="th">dis24_rank</th>
<th data-quarto-table-cell-role="th">dis24_rp</th>
<th data-quarto-table-cell-role="th">SFED_rank</th>
<th data-quarto-table-cell-role="th">SFED_rp</th>
<th data-quarto-table-cell-role="th">streamflow_rank</th>
<th data-quarto-table-cell-role="th">streamflow_rp</th>
<th data-quarto-table-cell-role="th">3yr_target</th>
<th data-quarto-table-cell-role="th">4yr_target</th>
<th data-quarto-table-cell-role="th">5yr_target</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1998</td>
<td>4300.250000</td>
<td>0.142014</td>
<td>1328.853149</td>
<td>1998-09-03</td>
<td>1998-09-29</td>
<td>1998-10-06</td>
<td>26 days</td>
<td>-7 days</td>
<td>3</td>
<td>9.000000</td>
<td>9</td>
<td>3.000000</td>
<td>4</td>
<td>6.750000</td>
<td>True</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1999</td>
<td>5244.656250</td>
<td>0.192214</td>
<td>1545.005493</td>
<td>1999-09-11</td>
<td>1999-10-21</td>
<td>1999-10-17</td>
<td>40 days</td>
<td>4 days</td>
<td>2</td>
<td>13.500000</td>
<td>5</td>
<td>5.400000</td>
<td>2</td>
<td>13.500000</td>
<td>True</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2000</td>
<td>2863.234375</td>
<td>0.112231</td>
<td>762.573181</td>
<td>2000-09-07</td>
<td>2000-09-02</td>
<td>2000-10-06</td>
<td>-5 days</td>
<td>-34 days</td>
<td>8</td>
<td>3.375000</td>
<td>14</td>
<td>1.928571</td>
<td>24</td>
<td>1.125000</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2001</td>
<td>2399.468750</td>
<td>0.061692</td>
<td>1064.437988</td>
<td>2001-09-20</td>
<td>2001-09-17</td>
<td>2001-10-04</td>
<td>-3 days</td>
<td>-17 days</td>
<td>13</td>
<td>2.076923</td>
<td>25</td>
<td>1.080000</td>
<td>8</td>
<td>3.375000</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2002</td>
<td>1854.218750</td>
<td>0.093438</td>
<td>956.879333</td>
<td>2002-09-19</td>
<td>2002-09-24</td>
<td>2002-09-16</td>
<td>5 days</td>
<td>8 days</td>
<td>22</td>
<td>1.227273</td>
<td>18</td>
<td>1.500000</td>
<td>11</td>
<td>2.454545</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2003</td>
<td>3312.015625</td>
<td>0.151862</td>
<td>953.153015</td>
<td>2003-09-19</td>
<td>2003-09-21</td>
<td>2003-09-30</td>
<td>2 days</td>
<td>-9 days</td>
<td>4</td>
<td>6.750000</td>
<td>7</td>
<td>3.857143</td>
<td>12</td>
<td>2.250000</td>
<td>True</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2004</td>
<td>1856.578125</td>
<td>0.035491</td>
<td>801.753296</td>
<td>2004-09-07</td>
<td>2004-09-11</td>
<td>2004-09-26</td>
<td>4 days</td>
<td>-15 days</td>
<td>21</td>
<td>1.285714</td>
<td>26</td>
<td>1.038462</td>
<td>20</td>
<td>1.350000</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2005</td>
<td>2077.328125</td>
<td>0.082421</td>
<td>903.818298</td>
<td>2005-08-15</td>
<td>2005-08-23</td>
<td>2005-10-07</td>
<td>8 days</td>
<td>-45 days</td>
<td>19</td>
<td>1.421053</td>
<td>23</td>
<td>1.173913</td>
<td>15</td>
<td>1.800000</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>2006</td>
<td>1733.757812</td>
<td>0.113096</td>
<td>847.273560</td>
<td>2006-09-23</td>
<td>2006-09-16</td>
<td>2006-09-17</td>
<td>-7 days</td>
<td>-1 days</td>
<td>23</td>
<td>1.173913</td>
<td>13</td>
<td>2.076923</td>
<td>18</td>
<td>1.500000</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>2007</td>
<td>2235.781250</td>
<td>0.103586</td>
<td>836.369751</td>
<td>2007-09-22</td>
<td>2007-09-12</td>
<td>2007-09-11</td>
<td>-10 days</td>
<td>1 days</td>
<td>17</td>
<td>1.588235</td>
<td>15</td>
<td>1.800000</td>
<td>19</td>
<td>1.421053</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>2008</td>
<td>2627.976562</td>
<td>0.083352</td>
<td>1063.593872</td>
<td>2008-08-27</td>
<td>2008-06-28</td>
<td>2008-10-03</td>
<td>-60 days</td>
<td>-97 days</td>
<td>9</td>
<td>3.000000</td>
<td>22</td>
<td>1.227273</td>
<td>9</td>
<td>3.000000</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>2009</td>
<td>2169.906250</td>
<td>0.103484</td>
<td>766.465027</td>
<td>2009-09-05</td>
<td>2009-09-08</td>
<td>2009-09-10</td>
<td>3 days</td>
<td>-2 days</td>
<td>18</td>
<td>1.500000</td>
<td>16</td>
<td>1.687500</td>
<td>23</td>
<td>1.173913</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>2010</td>
<td>3109.257812</td>
<td>0.115183</td>
<td>1100.995361</td>
<td>2010-09-07</td>
<td>2010-09-10</td>
<td>2010-10-01</td>
<td>3 days</td>
<td>-21 days</td>
<td>6</td>
<td>4.500000</td>
<td>12</td>
<td>2.250000</td>
<td>7</td>
<td>3.857143</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>2011</td>
<td>2461.625000</td>
<td>0.080652</td>
<td>778.979004</td>
<td>2011-09-14</td>
<td>2011-09-21</td>
<td>2011-10-18</td>
<td>7 days</td>
<td>-27 days</td>
<td>11</td>
<td>2.454545</td>
<td>24</td>
<td>1.125000</td>
<td>21</td>
<td>1.285714</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>2012</td>
<td>3110.078125</td>
<td>0.286909</td>
<td>1394.855469</td>
<td>2012-08-21</td>
<td>2012-09-21</td>
<td>2012-09-23</td>
<td>31 days</td>
<td>-2 days</td>
<td>5</td>
<td>5.400000</td>
<td>1</td>
<td>27.000000</td>
<td>3</td>
<td>9.000000</td>
<td>True</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>2013</td>
<td>1611.937500</td>
<td>0.092912</td>
<td>775.987488</td>
<td>2013-08-28</td>
<td>2013-09-02</td>
<td>2013-09-07</td>
<td>5 days</td>
<td>-5 days</td>
<td>25</td>
<td>1.080000</td>
<td>19</td>
<td>1.421053</td>
<td>22</td>
<td>1.227273</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>2014</td>
<td>2918.125000</td>
<td>0.100249</td>
<td>926.234802</td>
<td>2014-08-23</td>
<td>2014-08-31</td>
<td>2014-10-06</td>
<td>8 days</td>
<td>-36 days</td>
<td>7</td>
<td>3.857143</td>
<td>17</td>
<td>1.588235</td>
<td>14</td>
<td>1.928571</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>2015</td>
<td>1563.804688</td>
<td>0.206910</td>
<td>738.006592</td>
<td>2015-09-20</td>
<td>2015-09-05</td>
<td>2015-10-12</td>
<td>-15 days</td>
<td>-37 days</td>
<td>26</td>
<td>1.038462</td>
<td>3</td>
<td>9.000000</td>
<td>25</td>
<td>1.080000</td>
<td>True</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>2016</td>
<td>2364.773438</td>
<td>0.118837</td>
<td>969.453369</td>
<td>2016-09-22</td>
<td>2016-09-25</td>
<td>2016-10-09</td>
<td>3 days</td>
<td>-14 days</td>
<td>15</td>
<td>1.800000</td>
<td>11</td>
<td>2.454545</td>
<td>10</td>
<td>2.700000</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>2017</td>
<td>1717.898438</td>
<td>0.088970</td>
<td>952.680115</td>
<td>2017-08-22</td>
<td>2017-08-19</td>
<td>2017-09-26</td>
<td>-3 days</td>
<td>-38 days</td>
<td>24</td>
<td>1.125000</td>
<td>20</td>
<td>1.350000</td>
<td>13</td>
<td>2.076923</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>2018</td>
<td>2547.906250</td>
<td>0.165637</td>
<td>1157.043457</td>
<td>2018-09-28</td>
<td>2018-09-12</td>
<td>2018-09-16</td>
<td>-16 days</td>
<td>-4 days</td>
<td>10</td>
<td>2.700000</td>
<td>6</td>
<td>4.500000</td>
<td>6</td>
<td>4.500000</td>
<td>True</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>2019</td>
<td>2440.054688</td>
<td>0.147553</td>
<td>1212.237061</td>
<td>2019-10-11</td>
<td>2019-10-30</td>
<td>2019-10-27</td>
<td>19 days</td>
<td>3 days</td>
<td>12</td>
<td>2.250000</td>
<td>8</td>
<td>3.375000</td>
<td>5</td>
<td>5.400000</td>
<td>True</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>2020</td>
<td>1946.828125</td>
<td>0.087079</td>
<td>901.907959</td>
<td>2020-09-30</td>
<td>2020-10-05</td>
<td>2020-10-05</td>
<td>5 days</td>
<td>0 days</td>
<td>20</td>
<td>1.350000</td>
<td>21</td>
<td>1.285714</td>
<td>16</td>
<td>1.687500</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>2021</td>
<td>2253.296875</td>
<td>0.134848</td>
<td>676.297546</td>
<td>2021-07-09</td>
<td>2021-08-29</td>
<td>2021-09-05</td>
<td>51 days</td>
<td>-7 days</td>
<td>16</td>
<td>1.687500</td>
<td>10</td>
<td>2.700000</td>
<td>26</td>
<td>1.038462</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>2022</td>
<td>5347.171875</td>
<td>0.269161</td>
<td>1793.780396</td>
<td>2022-08-19</td>
<td>2022-09-21</td>
<td>2022-09-24</td>
<td>33 days</td>
<td>-3 days</td>
<td>1</td>
<td>27.000000</td>
<td>2</td>
<td>13.500000</td>
<td>1</td>
<td>27.000000</td>
<td>True</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>2023</td>
<td>2379.328125</td>
<td>0.203958</td>
<td>900.323486</td>
<td>2023-08-26</td>
<td>2023-10-09</td>
<td>2023-10-07</td>
<td>44 days</td>
<td>2 days</td>
<td>14</td>
<td>1.928571</td>
<td>4</td>
<td>6.750000</td>
<td>17</td>
<td>1.588235</td>
<td>True</td>
<td>True</td>
<td>True</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Quick comparing peak leadtimes. As expected GloFAS is quite early.</p>
<div id="c2e8ebba-ac39-4f83-a9a0-db5ec66326aa" class="cell" data-execution_count="20">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df_yearly_max.set_index(<span class="st">"year"</span>)[</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    [<span class="ss">f"</span><span class="sc">{</span>x<span class="sc">}</span><span class="ss">_peak_leadtime"</span> <span class="cf">for</span> x <span class="kw">in</span> [<span class="st">"dis24"</span>, <span class="st">"streamflow"</span>]]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>].plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="combined_gf_grrr_reanalysis_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Check against severity of flooding. Slight positive relationship? Which is good, because this means that the more severe flooding is, the earlier we will be.</p>
<div id="661a17f3-3d82-4b0d-bd9a-ec2d5aa7010e" class="cell" data-execution_count="21">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df_yearly_max.set_index(<span class="st">"SFED"</span>)[</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    [<span class="ss">f"</span><span class="sc">{</span>x<span class="sc">}</span><span class="ss">_peak_leadtime"</span> <span class="cf">for</span> x <span class="kw">in</span> [<span class="st">"dis24"</span>, <span class="st">"streamflow"</span>]]</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>].plot(marker<span class="op">=</span><span class="st">"."</span>, linewidth<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="combined_gf_grrr_reanalysis_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="6a37863a-28c9-4716-aa8e-b4556057f0eb" class="cell" data-execution_count="22">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df_in <span class="op">=</span> pd.DataFrame(columns<span class="op">=</span>[<span class="st">"year"</span>])</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> rp_target <span class="kw">in</span> rp_targets:</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    dicts <span class="op">=</span> []</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    thresh_fs <span class="op">=</span> df_yearly_max[df_yearly_max[<span class="ss">f"</span><span class="sc">{</span>rp_target<span class="sc">}</span><span class="ss">yr_target"</span>]][</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SFED"</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    ].<span class="bu">min</span>()</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> year, group <span class="kw">in</span> df_fs.groupby(df_fs[<span class="st">"valid_time"</span>].dt.year):</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        dff <span class="op">=</span> group[group[<span class="st">"SFED"</span>] <span class="op">&gt;=</span> thresh_fs]</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> dff.empty:</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>            dicts.append(</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>                {</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"year"</span>: year,</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>                    <span class="ss">f"SFED_</span><span class="sc">{</span>rp_target<span class="sc">}</span><span class="ss">yr_thresh_date"</span>: dff[<span class="st">"valid_time"</span>].<span class="bu">min</span>(),</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    df_in_rp <span class="op">=</span> pd.DataFrame(dicts)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    df_in <span class="op">=</span> df_in.merge(df_in_rp, how<span class="op">=</span><span class="st">"outer"</span>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>df_yearly_max <span class="op">=</span> df_yearly_max.merge(df_in, how<span class="op">=</span><span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Clunky way to do this, but determining the first day that the target RP threshold would’ve been reached (i.e., the day our target flooding starts).</p>
<div id="14143ccb-ad0c-4bfd-8b1d-39d20f494283" class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to avoid divide by zero warnings</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>np.seterr(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>{'divide': 'warn', 'over': 'warn', 'under': 'ignore', 'invalid': 'warn'}</code></pre>
</div>
</div>
<section id="iterate" class="level3" data-number="12.2.1">
<h3 data-number="12.2.1" class="anchored" data-anchor-id="iterate"><span class="header-section-number">12.2.1</span> Iterate</h3>
<p>Iterate over all possible combinations of GloFAS and Google forecast thresholds. Also iterate over the target RPs.</p>
<div id="246a7188-223b-423e-b08d-818def1120c4" class="cell" data-execution_count="24">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>total_years <span class="op">=</span> <span class="bu">len</span>(df_yearly_max)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>ranks <span class="op">=</span> <span class="bu">range</span>(total_years <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>dicts <span class="op">=</span> []</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>dfs_yearly <span class="op">=</span> []</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> gf_rank <span class="kw">in</span> tqdm(ranks):</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> gf_rank <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>        thresh_gf <span class="op">=</span> df_yearly_max.set_index(<span class="st">"dis24_rank"</span>).loc[gf_rank][<span class="st">"dis24"</span>]</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>        thresh_gf <span class="op">=</span> np.inf</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> gr_rank <span class="kw">in</span> ranks:</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> gr_rank <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>            thresh_gr <span class="op">=</span> df_yearly_max.set_index(<span class="st">"streamflow_rank"</span>).loc[</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>                gr_rank</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>            ][<span class="st">"streamflow"</span>]</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>            thresh_gr <span class="op">=</span> np.inf</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>        dff <span class="op">=</span> df_yearly_max[</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>            (df_yearly_max[<span class="st">"dis24_rank"</span>] <span class="op">&lt;=</span> gf_rank)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>            <span class="op">|</span> (df_yearly_max[<span class="st">"streamflow_rank"</span>] <span class="op">&lt;=</span> gr_rank)</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>        dff_daily <span class="op">=</span> df_compare[</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>            (df_compare[<span class="st">"dis24"</span>] <span class="op">&gt;=</span> thresh_gf)</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>            <span class="op">|</span> (df_compare[<span class="st">"streamflow"</span>] <span class="op">&gt;=</span> thresh_gr)</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>        pp_daily <span class="op">=</span> dff_daily[<span class="st">"year"</span>].nunique()</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>        df_trig_dates <span class="op">=</span> (</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>            dff_daily.groupby(<span class="st">"year"</span>)[<span class="st">"valid_time"</span>]</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>            .<span class="bu">min</span>()</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>            .reset_index()</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>            .rename(columns<span class="op">=</span>{<span class="st">"valid_time"</span>: <span class="st">"trig_date"</span>})</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>        dff <span class="op">=</span> dff.merge(df_trig_dates, how<span class="op">=</span><span class="st">"left"</span>)</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> ind_name, thresh <span class="kw">in</span> <span class="bu">zip</span>(</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>            [<span class="st">"dis24"</span>, <span class="st">"streamflow"</span>], [thresh_gf, thresh_gr]</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>        ):</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>            dff_daily_ind <span class="op">=</span> df_compare[df_compare[ind_name] <span class="op">&gt;=</span> thresh]</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>            df_trig_dates_ind <span class="op">=</span> (</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>                dff_daily_ind.groupby(<span class="st">"year"</span>)[<span class="st">"valid_time"</span>]</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>                .<span class="bu">min</span>()</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>                .reset_index()</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>                .rename(columns<span class="op">=</span>{<span class="st">"valid_time"</span>: <span class="ss">f"</span><span class="sc">{</span>ind_name<span class="sc">}</span><span class="ss">_trig_date"</span>})</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>            dff <span class="op">=</span> dff.merge(df_trig_dates_ind, how<span class="op">=</span><span class="st">"left"</span>)</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>        dff[<span class="st">"leadtime_peak"</span>] <span class="op">=</span> dff[<span class="st">"SFED_maxdate"</span>] <span class="op">-</span> dff[<span class="st">"trig_date"</span>]</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> rp_target <span class="kw">in</span> rp_targets:</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>            dff[<span class="ss">f"leadtime_</span><span class="sc">{</span>rp_target<span class="sc">}</span><span class="ss">yr_target"</span>] <span class="op">=</span> (</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>                dff[<span class="ss">f"SFED_</span><span class="sc">{</span>rp_target<span class="sc">}</span><span class="ss">yr_thresh_date"</span>] <span class="op">-</span> dff[<span class="st">"trig_date"</span>]</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>            p <span class="op">=</span> df_yearly_max[<span class="ss">f"</span><span class="sc">{</span>rp_target<span class="sc">}</span><span class="ss">yr_target"</span>].<span class="bu">sum</span>()</span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>            pp <span class="op">=</span> <span class="bu">len</span>(dff)</span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>            <span class="co"># just double check that the two ways to calculate</span></span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>            <span class="co"># positives agree</span></span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">assert</span> pp_daily <span class="op">==</span> pp</span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>            tp <span class="op">=</span> dff[<span class="ss">f"</span><span class="sc">{</span>rp_target<span class="sc">}</span><span class="ss">yr_target"</span>].<span class="bu">sum</span>()</span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>            fp <span class="op">=</span> pp <span class="op">-</span> tp</span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a>            tpr <span class="op">=</span> tp <span class="op">/</span> p</span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a>            ppv <span class="op">=</span> tp <span class="op">/</span> (tp <span class="op">+</span> fp)</span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a>            f1 <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> ppv <span class="op">*</span> tpr <span class="op">/</span> (ppv <span class="op">+</span> tpr)</span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>            dicts.append(</span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a>                {</span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"rp_target"</span>: rp_target,</span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"rp_gf"</span>: np.divide((total_years <span class="op">+</span> <span class="dv">1</span>), gf_rank),</span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"rp_gr"</span>: np.divide((total_years <span class="op">+</span> <span class="dv">1</span>), gr_rank),</span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"rp_combined"</span>: np.divide((total_years <span class="op">+</span> <span class="dv">1</span>), pp),</span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"tpr"</span>: tpr,</span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"lt"</span>: dff[<span class="ss">f"leadtime_</span><span class="sc">{</span>rp_target<span class="sc">}</span><span class="ss">yr_target"</span>].mean(),</span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"f1"</span>: f1,</span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"lt_peak"</span>: dff[dff[<span class="ss">f"</span><span class="sc">{</span>rp_target<span class="sc">}</span><span class="ss">yr_target"</span>]][</span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"leadtime_peak"</span></span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>                    ].mean(),</span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a>        dff[<span class="st">"rp_gf"</span>] <span class="op">=</span> np.divide((total_years <span class="op">+</span> <span class="dv">1</span>), gf_rank)</span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a>        dff[<span class="st">"rp_gr"</span>] <span class="op">=</span> np.divide((total_years <span class="op">+</span> <span class="dv">1</span>), gr_rank)</span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a>        dfs_yearly.append(dff)</span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a>df_rps <span class="op">=</span> pd.DataFrame(dicts)</span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a>df_rps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"7a6584c8b9124252bc95e7b2efe6d53e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">rp_target</th>
<th data-quarto-table-cell-role="th">rp_gf</th>
<th data-quarto-table-cell-role="th">rp_gr</th>
<th data-quarto-table-cell-role="th">rp_combined</th>
<th data-quarto-table-cell-role="th">tpr</th>
<th data-quarto-table-cell-role="th">lt</th>
<th data-quarto-table-cell-role="th">f1</th>
<th data-quarto-table-cell-role="th">lt_peak</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>3</td>
<td>inf</td>
<td>inf</td>
<td>inf</td>
<td>0.000000</td>
<td>NaT</td>
<td>NaN</td>
<td>NaT</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>4</td>
<td>inf</td>
<td>inf</td>
<td>inf</td>
<td>0.000000</td>
<td>NaT</td>
<td>NaN</td>
<td>NaT</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5</td>
<td>inf</td>
<td>inf</td>
<td>inf</td>
<td>0.000000</td>
<td>NaT</td>
<td>NaN</td>
<td>NaT</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>inf</td>
<td>27.000000</td>
<td>27.000000</td>
<td>0.111111</td>
<td>-28 days +00:00:00</td>
<td>0.200000</td>
<td>-3 days +00:00:00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>inf</td>
<td>27.000000</td>
<td>27.000000</td>
<td>0.166667</td>
<td>-26 days +00:00:00</td>
<td>0.285714</td>
<td>-3 days +00:00:00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2182</td>
<td>4</td>
<td>1.038462</td>
<td>1.080000</td>
<td>1.038462</td>
<td>1.000000</td>
<td>33 days 08:00:00</td>
<td>0.375000</td>
<td>42 days 20:00:00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2183</td>
<td>5</td>
<td>1.038462</td>
<td>1.080000</td>
<td>1.038462</td>
<td>1.000000</td>
<td>38 days 14:24:00</td>
<td>0.322581</td>
<td>46 days 09:36:00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2184</td>
<td>3</td>
<td>1.038462</td>
<td>1.038462</td>
<td>1.038462</td>
<td>1.000000</td>
<td>39 days 02:40:00</td>
<td>0.514286</td>
<td>49 days 16:00:00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2185</td>
<td>4</td>
<td>1.038462</td>
<td>1.038462</td>
<td>1.038462</td>
<td>1.000000</td>
<td>34 days 00:00:00</td>
<td>0.375000</td>
<td>43 days 12:00:00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2186</td>
<td>5</td>
<td>1.038462</td>
<td>1.038462</td>
<td>1.038462</td>
<td>1.000000</td>
<td>39 days 09:36:00</td>
<td>0.322581</td>
<td>47 days 04:48:00</td>
</tr>
</tbody>
</table>

<p>2187 rows × 8 columns</p>
</div>
</div>
</div>
<div id="ba01c24c-541c-4425-b2d1-82ebb64ea979" class="cell" data-execution_count="25">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set this to grab values easily later</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>df_all_simulations <span class="op">=</span> pd.concat(dfs_yearly, ignore_index<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="3996a9d2-e2c3-4853-a48b-9de7ec8f181e" class="cell" data-execution_count="26">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set probabilities</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> [<span class="st">"gr"</span>, <span class="st">"gf"</span>, <span class="st">"combined"</span>]:</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    df_rps[<span class="ss">f"prob_</span><span class="sc">{</span>x<span class="sc">}</span><span class="ss">"</span>] <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> df_rps[<span class="ss">f"rp_</span><span class="sc">{</span>x<span class="sc">}</span><span class="ss">"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Come up with a measure <code>rel_prob_gr</code> that represents the balance between Google and GloFAS. When it is 1, we always trigger with Google (never with GloFAS), and when it is -1, we always trigger with GloFAS (never with Google).</p>
<div id="bde0731f-b63a-4ba7-8742-cf576b014a95" class="cell" data-execution_count="27">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df_rps[<span class="st">"rel_prob_gr"</span>] <span class="op">=</span> (df_rps[<span class="st">"prob_gr"</span>] <span class="op">-</span> df_rps[<span class="st">"prob_gf"</span>]) <span class="op">/</span> df_rps[</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"prob_combined"</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>df_rps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">rp_target</th>
<th data-quarto-table-cell-role="th">rp_gf</th>
<th data-quarto-table-cell-role="th">rp_gr</th>
<th data-quarto-table-cell-role="th">rp_combined</th>
<th data-quarto-table-cell-role="th">tpr</th>
<th data-quarto-table-cell-role="th">lt</th>
<th data-quarto-table-cell-role="th">f1</th>
<th data-quarto-table-cell-role="th">lt_peak</th>
<th data-quarto-table-cell-role="th">prob_gr</th>
<th data-quarto-table-cell-role="th">prob_gf</th>
<th data-quarto-table-cell-role="th">prob_combined</th>
<th data-quarto-table-cell-role="th">rel_prob_gr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>3</td>
<td>inf</td>
<td>inf</td>
<td>inf</td>
<td>0.000000</td>
<td>NaT</td>
<td>NaN</td>
<td>NaT</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>4</td>
<td>inf</td>
<td>inf</td>
<td>inf</td>
<td>0.000000</td>
<td>NaT</td>
<td>NaN</td>
<td>NaT</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5</td>
<td>inf</td>
<td>inf</td>
<td>inf</td>
<td>0.000000</td>
<td>NaT</td>
<td>NaN</td>
<td>NaT</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>inf</td>
<td>27.000000</td>
<td>27.000000</td>
<td>0.111111</td>
<td>-28 days +00:00:00</td>
<td>0.200000</td>
<td>-3 days +00:00:00</td>
<td>0.037037</td>
<td>0.000000</td>
<td>0.037037</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>inf</td>
<td>27.000000</td>
<td>27.000000</td>
<td>0.166667</td>
<td>-26 days +00:00:00</td>
<td>0.285714</td>
<td>-3 days +00:00:00</td>
<td>0.037037</td>
<td>0.000000</td>
<td>0.037037</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2182</td>
<td>4</td>
<td>1.038462</td>
<td>1.080000</td>
<td>1.038462</td>
<td>1.000000</td>
<td>33 days 08:00:00</td>
<td>0.375000</td>
<td>42 days 20:00:00</td>
<td>0.925926</td>
<td>0.962963</td>
<td>0.962963</td>
<td>-0.038462</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2183</td>
<td>5</td>
<td>1.038462</td>
<td>1.080000</td>
<td>1.038462</td>
<td>1.000000</td>
<td>38 days 14:24:00</td>
<td>0.322581</td>
<td>46 days 09:36:00</td>
<td>0.925926</td>
<td>0.962963</td>
<td>0.962963</td>
<td>-0.038462</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2184</td>
<td>3</td>
<td>1.038462</td>
<td>1.038462</td>
<td>1.038462</td>
<td>1.000000</td>
<td>39 days 02:40:00</td>
<td>0.514286</td>
<td>49 days 16:00:00</td>
<td>0.962963</td>
<td>0.962963</td>
<td>0.962963</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2185</td>
<td>4</td>
<td>1.038462</td>
<td>1.038462</td>
<td>1.038462</td>
<td>1.000000</td>
<td>34 days 00:00:00</td>
<td>0.375000</td>
<td>43 days 12:00:00</td>
<td>0.962963</td>
<td>0.962963</td>
<td>0.962963</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2186</td>
<td>5</td>
<td>1.038462</td>
<td>1.038462</td>
<td>1.038462</td>
<td>1.000000</td>
<td>39 days 09:36:00</td>
<td>0.322581</td>
<td>47 days 04:48:00</td>
<td>0.962963</td>
<td>0.962963</td>
<td>0.962963</td>
<td>0.000000</td>
</tr>
</tbody>
</table>

<p>2187 rows × 12 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="plots" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="plots"><span class="header-section-number">12.3</span> Plots</h2>
<div id="19dc43cc-9000-45c7-8ae0-37d8d11355e9" class="cell" data-execution_count="28">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_metrics_rel_prob(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    rp_target: <span class="bu">int</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    plot_metric: <span class="bu">str</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    peak_lt: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    max_plot_rp: <span class="bu">int</span> <span class="op">=</span> <span class="dv">5</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    min_plot_rp: <span class="bu">int</span> <span class="op">=</span> <span class="dv">3</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Plot accuracy metrics and leadtime for multiple overall RPs"""</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    lt_col <span class="op">=</span> <span class="st">"lt_peak"</span> <span class="cf">if</span> peak_lt <span class="cf">else</span> <span class="st">"lt"</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    df_plot <span class="op">=</span> df_rps[</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>        (df_rps[<span class="st">"rp_combined"</span>] <span class="op">&lt;=</span> max_plot_rp)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (df_rps[<span class="st">"rp_combined"</span>] <span class="op">&gt;=</span> min_plot_rp)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (df_rps[<span class="st">"rp_target"</span>] <span class="op">==</span> rp_target)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(dpi<span class="op">=</span><span class="dv">200</span>, figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">7</span>))</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    ax2 <span class="op">=</span> ax.twinx()</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    color_cycle <span class="op">=</span> plt.rcParams[<span class="st">"axes.prop_cycle"</span>].by_key()[<span class="st">"color"</span>]</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, (rp_combined, group) <span class="kw">in</span> <span class="bu">enumerate</span>(df_plot.groupby(<span class="st">"rp_combined"</span>)):</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>        group <span class="op">=</span> group.sort_values(<span class="st">"rel_prob_gr"</span>)</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>        color <span class="op">=</span> color_cycle[</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>            i <span class="op">%</span> <span class="bu">len</span>(color_cycle)</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>        ]  <span class="co"># cycle through colors safely</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>        ax.plot(</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>            group[<span class="st">"rel_prob_gr"</span>],</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>            group[plot_metric],</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="ss">f"</span><span class="sc">{</span>rp_combined<span class="sc">:.1f}</span><span class="ss">"</span>,</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span>color,</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>            linestyle<span class="op">=</span><span class="st">"-"</span>,</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>        ax2.plot(</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>            group[<span class="st">"rel_prob_gr"</span>],</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>            group[lt_col].dt.days,</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span>color,</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>            linestyle<span class="op">=</span><span class="st">"--"</span>,</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Only add legend for rp_combined once (from ax)</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>    ax.legend(</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">"Overall RP (years)</span><span class="ch">\n</span><span class="st">solid: accuracy metric</span><span class="ch">\n</span><span class="st">dashed: leadtime"</span>,</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>        bbox_to_anchor<span class="op">=</span>(<span class="fl">1.1</span>, <span class="dv">1</span>),</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>        loc<span class="op">=</span><span class="st">"upper left"</span>,</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>    ax.axvline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">"lightgrey"</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, linestyle<span class="op">=</span><span class="st">"--"</span>)</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Labels</span></span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Relative probability of activating</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>        <span class="st">"&lt;-- more likely with GloFAS              more likely with Google --&gt;"</span></span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(plot_metric.upper())</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>    lt_label <span class="op">=</span> <span class="st">"peak flooding"</span> <span class="cf">if</span> peak_lt <span class="cf">else</span> <span class="st">"target flooding threshold"</span></span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>    ax2.set_ylabel(<span class="ss">f"Leadtime to </span><span class="sc">{</span>lt_label<span class="sc">}</span><span class="ss"> (days)"</span>)</span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim([<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim([<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>    ax2.set_ylim([<span class="dv">0</span>, <span class="dv">40</span>])</span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>    ax.set_title(</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"GloFAS/Google comparison, target </span><span class="sc">{</span>rp_target<span class="sc">}</span><span class="ss">-yr RP flooding</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>        <span class="st">"solid: accruacy metric, dashed: leadtime"</span></span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="ba4d6964-99a6-4a7a-9cf4-20a8cc6e75d7" class="cell" data-execution_count="29">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>plot_metrics_rel_prob(<span class="dv">5</span>, <span class="st">"f1"</span>, peak_lt<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="combined_gf_grrr_reanalysis_files/figure-html/cell-26-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="29fe74f2-5531-4b6e-b320-86269a6a6041" class="cell" data-execution_count="30">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>plot_metrics_rel_prob(<span class="dv">3</span>, <span class="st">"f1"</span>, peak_lt<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="combined_gf_grrr_reanalysis_files/figure-html/cell-27-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="06717cfa-4fa0-4ab4-85bc-a8c35c341d3c" class="cell" data-execution_count="31">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>plot_metrics_rel_prob(<span class="dv">4</span>, <span class="st">"f1"</span>, peak_lt<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="combined_gf_grrr_reanalysis_files/figure-html/cell-28-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="7897b9de-133a-4d20-8297-0e9876483b81" class="cell" data-execution_count="32">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>plot_metrics_rel_prob(<span class="dv">5</span>, <span class="st">"f1"</span>, peak_lt<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="combined_gf_grrr_reanalysis_files/figure-html/cell-29-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="specific-overall-rp" class="level3" data-number="12.3.1">
<h3 data-number="12.3.1" class="anchored" data-anchor-id="specific-overall-rp"><span class="header-section-number">12.3.1</span> Specific overall RP</h3>
<p>Look at only the overall RP specified by CERF (4.5 years).</p>
<div id="d3a47be5-a16b-4c5f-bcde-e86f92eca7ea" class="cell" data-execution_count="33">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df_rps_acceptable = df_rps[</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     (df_rps["rp_combined"] &lt;= 5) &amp; (df_rps["rp_combined"] &gt;= 3)</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ]</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>acceptable_rp <span class="op">=</span> (total_years <span class="op">+</span> <span class="dv">1</span>) <span class="op">/</span> <span class="dv">6</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>df_rps_acceptable <span class="op">=</span> df_rps[df_rps[<span class="st">"rp_combined"</span>] <span class="op">==</span> acceptable_rp].copy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="2a1b9863-5a04-4e2e-a14f-2614bab8bf6c" class="cell" data-scrolled="true" data-execution_count="34">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df_rps_acceptable</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="34">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">rp_target</th>
<th data-quarto-table-cell-role="th">rp_gf</th>
<th data-quarto-table-cell-role="th">rp_gr</th>
<th data-quarto-table-cell-role="th">rp_combined</th>
<th data-quarto-table-cell-role="th">tpr</th>
<th data-quarto-table-cell-role="th">lt</th>
<th data-quarto-table-cell-role="th">f1</th>
<th data-quarto-table-cell-role="th">lt_peak</th>
<th data-quarto-table-cell-role="th">prob_gr</th>
<th data-quarto-table-cell-role="th">prob_gf</th>
<th data-quarto-table-cell-role="th">prob_combined</th>
<th data-quarto-table-cell-role="th">rel_prob_gr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>3</td>
<td>inf</td>
<td>4.50</td>
<td>4.5</td>
<td>0.666667</td>
<td>0 days 20:00:00</td>
<td>0.800000</td>
<td>15 days 08:00:00</td>
<td>0.222222</td>
<td>0.000000</td>
<td>0.222222</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>4</td>
<td>inf</td>
<td>4.50</td>
<td>4.5</td>
<td>0.666667</td>
<td>7 days 12:00:00</td>
<td>0.666667</td>
<td>20 days 12:00:00</td>
<td>0.222222</td>
<td>0.000000</td>
<td>0.222222</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>5</td>
<td>inf</td>
<td>4.50</td>
<td>4.5</td>
<td>0.600000</td>
<td>16 days 16:00:00</td>
<td>0.545455</td>
<td>28 days 16:00:00</td>
<td>0.222222</td>
<td>0.000000</td>
<td>0.222222</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">99</td>
<td>3</td>
<td>27.00</td>
<td>4.50</td>
<td>4.5</td>
<td>0.666667</td>
<td>3 days 12:00:00</td>
<td>0.800000</td>
<td>18 days 00:00:00</td>
<td>0.222222</td>
<td>0.037037</td>
<td>0.222222</td>
<td>0.833333</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">100</td>
<td>4</td>
<td>27.00</td>
<td>4.50</td>
<td>4.5</td>
<td>0.666667</td>
<td>11 days 12:00:00</td>
<td>0.666667</td>
<td>24 days 12:00:00</td>
<td>0.222222</td>
<td>0.037037</td>
<td>0.222222</td>
<td>0.833333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">101</td>
<td>5</td>
<td>27.00</td>
<td>4.50</td>
<td>4.5</td>
<td>0.600000</td>
<td>22 days 00:00:00</td>
<td>0.545455</td>
<td>34 days 00:00:00</td>
<td>0.222222</td>
<td>0.037037</td>
<td>0.222222</td>
<td>0.833333</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">180</td>
<td>3</td>
<td>13.50</td>
<td>4.50</td>
<td>4.5</td>
<td>0.666667</td>
<td>3 days 12:00:00</td>
<td>0.800000</td>
<td>18 days 00:00:00</td>
<td>0.222222</td>
<td>0.074074</td>
<td>0.222222</td>
<td>0.666667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">181</td>
<td>4</td>
<td>13.50</td>
<td>4.50</td>
<td>4.5</td>
<td>0.666667</td>
<td>11 days 12:00:00</td>
<td>0.666667</td>
<td>24 days 12:00:00</td>
<td>0.222222</td>
<td>0.074074</td>
<td>0.222222</td>
<td>0.666667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">182</td>
<td>5</td>
<td>13.50</td>
<td>4.50</td>
<td>4.5</td>
<td>0.600000</td>
<td>22 days 00:00:00</td>
<td>0.545455</td>
<td>34 days 00:00:00</td>
<td>0.222222</td>
<td>0.074074</td>
<td>0.222222</td>
<td>0.666667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">261</td>
<td>3</td>
<td>9.00</td>
<td>4.50</td>
<td>4.5</td>
<td>0.666667</td>
<td>7 days 08:00:00</td>
<td>0.800000</td>
<td>21 days 20:00:00</td>
<td>0.222222</td>
<td>0.111111</td>
<td>0.222222</td>
<td>0.500000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">262</td>
<td>4</td>
<td>9.00</td>
<td>4.50</td>
<td>4.5</td>
<td>0.666667</td>
<td>11 days 12:00:00</td>
<td>0.666667</td>
<td>24 days 12:00:00</td>
<td>0.222222</td>
<td>0.111111</td>
<td>0.222222</td>
<td>0.500000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">263</td>
<td>5</td>
<td>9.00</td>
<td>4.50</td>
<td>4.5</td>
<td>0.600000</td>
<td>22 days 00:00:00</td>
<td>0.545455</td>
<td>34 days 00:00:00</td>
<td>0.222222</td>
<td>0.111111</td>
<td>0.222222</td>
<td>0.500000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">339</td>
<td>3</td>
<td>6.75</td>
<td>5.40</td>
<td>4.5</td>
<td>0.666667</td>
<td>11 days 08:00:00</td>
<td>0.800000</td>
<td>23 days 16:00:00</td>
<td>0.185185</td>
<td>0.148148</td>
<td>0.222222</td>
<td>0.166667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">340</td>
<td>4</td>
<td>6.75</td>
<td>5.40</td>
<td>4.5</td>
<td>0.500000</td>
<td>14 days 16:00:00</td>
<td>0.500000</td>
<td>32 days 00:00:00</td>
<td>0.185185</td>
<td>0.148148</td>
<td>0.222222</td>
<td>0.166667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">341</td>
<td>5</td>
<td>6.75</td>
<td>5.40</td>
<td>4.5</td>
<td>0.600000</td>
<td>20 days 00:00:00</td>
<td>0.545455</td>
<td>32 days 00:00:00</td>
<td>0.185185</td>
<td>0.148148</td>
<td>0.222222</td>
<td>0.166667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">420</td>
<td>3</td>
<td>5.40</td>
<td>5.40</td>
<td>4.5</td>
<td>0.666667</td>
<td>13 days 16:00:00</td>
<td>0.800000</td>
<td>26 days 00:00:00</td>
<td>0.185185</td>
<td>0.185185</td>
<td>0.222222</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">421</td>
<td>4</td>
<td>5.40</td>
<td>5.40</td>
<td>4.5</td>
<td>0.500000</td>
<td>19 days 08:00:00</td>
<td>0.500000</td>
<td>36 days 16:00:00</td>
<td>0.185185</td>
<td>0.185185</td>
<td>0.222222</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">422</td>
<td>5</td>
<td>5.40</td>
<td>5.40</td>
<td>4.5</td>
<td>0.600000</td>
<td>24 days 16:00:00</td>
<td>0.545455</td>
<td>36 days 16:00:00</td>
<td>0.185185</td>
<td>0.185185</td>
<td>0.222222</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">486</td>
<td>3</td>
<td>4.50</td>
<td>inf</td>
<td>4.5</td>
<td>0.555556</td>
<td>15 days 19:12:00</td>
<td>0.666667</td>
<td>30 days 14:24:00</td>
<td>0.000000</td>
<td>0.222222</td>
<td>0.222222</td>
<td>-1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">487</td>
<td>4</td>
<td>4.50</td>
<td>inf</td>
<td>4.5</td>
<td>0.500000</td>
<td>19 days 08:00:00</td>
<td>0.500000</td>
<td>36 days 16:00:00</td>
<td>0.000000</td>
<td>0.222222</td>
<td>0.222222</td>
<td>-1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">488</td>
<td>5</td>
<td>4.50</td>
<td>inf</td>
<td>4.5</td>
<td>0.600000</td>
<td>24 days 16:00:00</td>
<td>0.545455</td>
<td>36 days 16:00:00</td>
<td>0.000000</td>
<td>0.222222</td>
<td>0.222222</td>
<td>-1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">489</td>
<td>3</td>
<td>4.50</td>
<td>27.00</td>
<td>4.5</td>
<td>0.555556</td>
<td>15 days 19:12:00</td>
<td>0.666667</td>
<td>30 days 14:24:00</td>
<td>0.037037</td>
<td>0.222222</td>
<td>0.222222</td>
<td>-0.833333</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">490</td>
<td>4</td>
<td>4.50</td>
<td>27.00</td>
<td>4.5</td>
<td>0.500000</td>
<td>19 days 08:00:00</td>
<td>0.500000</td>
<td>36 days 16:00:00</td>
<td>0.037037</td>
<td>0.222222</td>
<td>0.222222</td>
<td>-0.833333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">491</td>
<td>5</td>
<td>4.50</td>
<td>27.00</td>
<td>4.5</td>
<td>0.600000</td>
<td>24 days 16:00:00</td>
<td>0.545455</td>
<td>36 days 16:00:00</td>
<td>0.037037</td>
<td>0.222222</td>
<td>0.222222</td>
<td>-0.833333</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">492</td>
<td>3</td>
<td>4.50</td>
<td>13.50</td>
<td>4.5</td>
<td>0.555556</td>
<td>15 days 19:12:00</td>
<td>0.666667</td>
<td>30 days 14:24:00</td>
<td>0.074074</td>
<td>0.222222</td>
<td>0.222222</td>
<td>-0.666667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">493</td>
<td>4</td>
<td>4.50</td>
<td>13.50</td>
<td>4.5</td>
<td>0.500000</td>
<td>19 days 08:00:00</td>
<td>0.500000</td>
<td>36 days 16:00:00</td>
<td>0.074074</td>
<td>0.222222</td>
<td>0.222222</td>
<td>-0.666667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">494</td>
<td>5</td>
<td>4.50</td>
<td>13.50</td>
<td>4.5</td>
<td>0.600000</td>
<td>24 days 16:00:00</td>
<td>0.545455</td>
<td>36 days 16:00:00</td>
<td>0.074074</td>
<td>0.222222</td>
<td>0.222222</td>
<td>-0.666667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">495</td>
<td>3</td>
<td>4.50</td>
<td>9.00</td>
<td>4.5</td>
<td>0.555556</td>
<td>15 days 19:12:00</td>
<td>0.666667</td>
<td>30 days 14:24:00</td>
<td>0.111111</td>
<td>0.222222</td>
<td>0.222222</td>
<td>-0.500000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">496</td>
<td>4</td>
<td>4.50</td>
<td>9.00</td>
<td>4.5</td>
<td>0.500000</td>
<td>19 days 08:00:00</td>
<td>0.500000</td>
<td>36 days 16:00:00</td>
<td>0.111111</td>
<td>0.222222</td>
<td>0.222222</td>
<td>-0.500000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">497</td>
<td>5</td>
<td>4.50</td>
<td>9.00</td>
<td>4.5</td>
<td>0.600000</td>
<td>24 days 16:00:00</td>
<td>0.545455</td>
<td>36 days 16:00:00</td>
<td>0.111111</td>
<td>0.222222</td>
<td>0.222222</td>
<td>-0.500000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">498</td>
<td>3</td>
<td>4.50</td>
<td>6.75</td>
<td>4.5</td>
<td>0.555556</td>
<td>15 days 19:12:00</td>
<td>0.666667</td>
<td>30 days 14:24:00</td>
<td>0.148148</td>
<td>0.222222</td>
<td>0.222222</td>
<td>-0.333333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">499</td>
<td>4</td>
<td>4.50</td>
<td>6.75</td>
<td>4.5</td>
<td>0.500000</td>
<td>19 days 08:00:00</td>
<td>0.500000</td>
<td>36 days 16:00:00</td>
<td>0.148148</td>
<td>0.222222</td>
<td>0.222222</td>
<td>-0.333333</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">500</td>
<td>5</td>
<td>4.50</td>
<td>6.75</td>
<td>4.5</td>
<td>0.600000</td>
<td>24 days 16:00:00</td>
<td>0.545455</td>
<td>36 days 16:00:00</td>
<td>0.148148</td>
<td>0.222222</td>
<td>0.222222</td>
<td>-0.333333</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="99aaf70a-7435-4170-a480-5a67e7171a38" class="cell" data-execution_count="35">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_metrics_one_overallrp(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    plot_metric: <span class="bu">str</span>,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    peak_lt: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    lt_col <span class="op">=</span> <span class="st">"lt_peak"</span> <span class="cf">if</span> peak_lt <span class="cf">else</span> <span class="st">"lt"</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    df_plot <span class="op">=</span> df_rps_acceptable.copy()</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(dpi<span class="op">=</span><span class="dv">200</span>, figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">7</span>))</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    ax2 <span class="op">=</span> ax.twinx()</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    color_cycle <span class="op">=</span> plt.rcParams[<span class="st">"axes.prop_cycle"</span>].by_key()[<span class="st">"color"</span>]</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, (rp_target, group) <span class="kw">in</span> <span class="bu">enumerate</span>(df_plot.groupby(<span class="st">"rp_target"</span>)):</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>        group <span class="op">=</span> group.sort_values(<span class="st">"rel_prob_gr"</span>)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>        color <span class="op">=</span> color_cycle[</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>            i <span class="op">%</span> <span class="bu">len</span>(color_cycle)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>        ]  <span class="co"># cycle through colors safely</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>        ax.plot(</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>            group[<span class="st">"rel_prob_gr"</span>],</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>            group[plot_metric],</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span>rp_target,</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span>color,</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>            linestyle<span class="op">=</span><span class="st">"-"</span>,</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>        ax2.plot(</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>            group[<span class="st">"rel_prob_gr"</span>],</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>            group[lt_col].dt.days,</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span>color,</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>            linestyle<span class="op">=</span><span class="st">"--"</span>,</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Only add legend for rp_combined once (from ax)</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>    ax.legend(</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">"Target RP (years)</span><span class="ch">\n</span><span class="st">solid: accuracy metric</span><span class="ch">\n</span><span class="st">dashed: leadtime"</span>,</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>        bbox_to_anchor<span class="op">=</span>(<span class="fl">1.1</span>, <span class="dv">1</span>),</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>        loc<span class="op">=</span><span class="st">"upper left"</span>,</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>    ax.axvline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">"lightgrey"</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, linestyle<span class="op">=</span><span class="st">"--"</span>)</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Labels</span></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Relative probability of activating</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>        <span class="st">"&lt;-- more likely with GloFAS              more likely with Google --&gt;"</span></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(plot_metric.upper())</span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>    lt_label <span class="op">=</span> <span class="st">"peak flooding"</span> <span class="cf">if</span> peak_lt <span class="cf">else</span> <span class="st">"target flooding threshold"</span></span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>    ax2.set_ylabel(<span class="ss">f"Leadtime to </span><span class="sc">{</span>lt_label<span class="sc">}</span><span class="ss"> (days)"</span>)</span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim([<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim([<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>    ax2.set_ylim([<span class="dv">0</span>, <span class="dv">40</span>])</span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>    ax.set_title(</span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"GloFAS/Google comparison, overall </span><span class="sc">{</span>acceptable_rp<span class="sc">:.1f}</span><span class="ss">-yr RP</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>        <span class="st">"solid: accruacy metric, dashed: leadtime"</span></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="a89877e9-41ec-492f-800d-b9180bb5fffa" class="cell" data-execution_count="36">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>plot_metrics_one_overallrp(<span class="st">"f1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="combined_gf_grrr_reanalysis_files/figure-html/cell-33-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="307af240-f58c-4ca8-8218-55e16dddb580" class="cell" data-execution_count="37">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>plot_metrics_one_overallrp(<span class="st">"tpr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="combined_gf_grrr_reanalysis_files/figure-html/cell-34-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="specific-combination" class="level2" data-number="12.4">
<h2 data-number="12.4" class="anchored" data-anchor-id="specific-combination"><span class="header-section-number">12.4</span> Specific combination</h2>
<p>Pick specification combination based on accuracy metrics. Looks like a balanced trigger (equal probability to activate with both) seems to provide decent combination of accuracy and leadtime. We can then look at the historical performance in more detail.</p>
<div id="b3fc7ef9-f00e-4815-aa4e-f6fee9dd95ac" class="cell" data-execution_count="38">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df_rps_acceptable[df_rps_acceptable[<span class="st">"rel_prob_gr"</span>] <span class="op">==</span> <span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="38">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">rp_target</th>
<th data-quarto-table-cell-role="th">rp_gf</th>
<th data-quarto-table-cell-role="th">rp_gr</th>
<th data-quarto-table-cell-role="th">rp_combined</th>
<th data-quarto-table-cell-role="th">tpr</th>
<th data-quarto-table-cell-role="th">lt</th>
<th data-quarto-table-cell-role="th">f1</th>
<th data-quarto-table-cell-role="th">lt_peak</th>
<th data-quarto-table-cell-role="th">prob_gr</th>
<th data-quarto-table-cell-role="th">prob_gf</th>
<th data-quarto-table-cell-role="th">prob_combined</th>
<th data-quarto-table-cell-role="th">rel_prob_gr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">420</td>
<td>3</td>
<td>5.4</td>
<td>5.4</td>
<td>4.5</td>
<td>0.666667</td>
<td>13 days 16:00:00</td>
<td>0.800000</td>
<td>26 days 00:00:00</td>
<td>0.185185</td>
<td>0.185185</td>
<td>0.222222</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">421</td>
<td>4</td>
<td>5.4</td>
<td>5.4</td>
<td>4.5</td>
<td>0.500000</td>
<td>19 days 08:00:00</td>
<td>0.500000</td>
<td>36 days 16:00:00</td>
<td>0.185185</td>
<td>0.185185</td>
<td>0.222222</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">422</td>
<td>5</td>
<td>5.4</td>
<td>5.4</td>
<td>4.5</td>
<td>0.600000</td>
<td>24 days 16:00:00</td>
<td>0.545455</td>
<td>36 days 16:00:00</td>
<td>0.185185</td>
<td>0.185185</td>
<td>0.222222</td>
<td>0.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cd504b27-3e90-4b90-93c0-b4d2ecef963d" class="cell" data-execution_count="39">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># based on reading of above df, we want individual RPs 5.4 years</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>df_selected_trigger <span class="op">=</span> df_all_simulations[</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    (df_all_simulations[<span class="st">"rp_gf"</span>] <span class="op">==</span> <span class="fl">5.4</span>) <span class="op">&amp;</span> (df_all_simulations[<span class="st">"rp_gr"</span>] <span class="op">==</span> <span class="fl">5.4</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="f497e768-b3a3-4bf4-9453-82ae6011ade6" class="cell" data-execution_count="40">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df_selected_trigger <span class="op">=</span> df_yearly_max.merge(df_selected_trigger, how<span class="op">=</span><span class="st">"outer"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="f56295e5-e1de-4d51-a231-4b02476c20ac" class="cell" data-execution_count="41">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>rp_target <span class="op">=</span> <span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Get actual thresholds</p>
<div id="56a9dce7-f112-4da3-beef-27f284b669db" class="cell" data-scrolled="true" data-execution_count="42">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>df_selected_trigger.sort_values(<span class="st">"dis24"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">dis24</th>
<th data-quarto-table-cell-role="th">SFED</th>
<th data-quarto-table-cell-role="th">streamflow</th>
<th data-quarto-table-cell-role="th">dis24_maxdate</th>
<th data-quarto-table-cell-role="th">SFED_maxdate</th>
<th data-quarto-table-cell-role="th">streamflow_maxdate</th>
<th data-quarto-table-cell-role="th">dis24_peak_leadtime</th>
<th data-quarto-table-cell-role="th">streamflow_peak_leadtime</th>
<th data-quarto-table-cell-role="th">dis24_rank</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">SFED_5yr_thresh_date</th>
<th data-quarto-table-cell-role="th">trig_date</th>
<th data-quarto-table-cell-role="th">dis24_trig_date</th>
<th data-quarto-table-cell-role="th">streamflow_trig_date</th>
<th data-quarto-table-cell-role="th">leadtime_peak</th>
<th data-quarto-table-cell-role="th">leadtime_3yr_target</th>
<th data-quarto-table-cell-role="th">leadtime_4yr_target</th>
<th data-quarto-table-cell-role="th">leadtime_5yr_target</th>
<th data-quarto-table-cell-role="th">rp_gf</th>
<th data-quarto-table-cell-role="th">rp_gr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>2022</td>
<td>5347.171875</td>
<td>0.269161</td>
<td>1793.780396</td>
<td>2022-08-19</td>
<td>2022-09-21</td>
<td>2022-09-24</td>
<td>33 days</td>
<td>-3 days</td>
<td>1</td>
<td>...</td>
<td>2022-09-10</td>
<td>2022-08-19</td>
<td>2022-08-19</td>
<td>2022-09-04</td>
<td>33 days</td>
<td>8 days</td>
<td>10 days</td>
<td>22 days</td>
<td>5.4</td>
<td>5.4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1999</td>
<td>5244.656250</td>
<td>0.192214</td>
<td>1545.005493</td>
<td>1999-09-11</td>
<td>1999-10-21</td>
<td>1999-10-17</td>
<td>40 days</td>
<td>4 days</td>
<td>2</td>
<td>...</td>
<td>1999-10-21</td>
<td>1999-09-05</td>
<td>1999-09-05</td>
<td>1999-09-10</td>
<td>46 days</td>
<td>27 days</td>
<td>43 days</td>
<td>46 days</td>
<td>5.4</td>
<td>5.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1998</td>
<td>4300.250000</td>
<td>0.142014</td>
<td>1328.853149</td>
<td>1998-09-03</td>
<td>1998-09-29</td>
<td>1998-10-06</td>
<td>26 days</td>
<td>-7 days</td>
<td>3</td>
<td>...</td>
<td>NaT</td>
<td>1998-08-19</td>
<td>1998-08-19</td>
<td>1998-09-28</td>
<td>41 days</td>
<td>41 days</td>
<td>NaT</td>
<td>NaT</td>
<td>5.4</td>
<td>5.4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2003</td>
<td>3312.015625</td>
<td>0.151862</td>
<td>953.153015</td>
<td>2003-09-19</td>
<td>2003-09-21</td>
<td>2003-09-30</td>
<td>2 days</td>
<td>-9 days</td>
<td>4</td>
<td>...</td>
<td>NaT</td>
<td>2003-09-19</td>
<td>2003-09-19</td>
<td>NaT</td>
<td>2 days</td>
<td>1 days</td>
<td>NaT</td>
<td>NaT</td>
<td>5.4</td>
<td>5.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>2012</td>
<td>3110.078125</td>
<td>0.286909</td>
<td>1394.855469</td>
<td>2012-08-21</td>
<td>2012-09-21</td>
<td>2012-09-23</td>
<td>31 days</td>
<td>-2 days</td>
<td>5</td>
<td>...</td>
<td>2012-08-27</td>
<td>2012-08-21</td>
<td>2012-08-21</td>
<td>2012-09-02</td>
<td>31 days</td>
<td>2 days</td>
<td>5 days</td>
<td>6 days</td>
<td>5.4</td>
<td>5.4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>2010</td>
<td>3109.257812</td>
<td>0.115183</td>
<td>1100.995361</td>
<td>2010-09-07</td>
<td>2010-09-10</td>
<td>2010-10-01</td>
<td>3 days</td>
<td>-21 days</td>
<td>6</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>2014</td>
<td>2918.125000</td>
<td>0.100249</td>
<td>926.234802</td>
<td>2014-08-23</td>
<td>2014-08-31</td>
<td>2014-10-06</td>
<td>8 days</td>
<td>-36 days</td>
<td>7</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>2000</td>
<td>2863.234375</td>
<td>0.112231</td>
<td>762.573181</td>
<td>2000-09-07</td>
<td>2000-09-02</td>
<td>2000-10-06</td>
<td>-5 days</td>
<td>-34 days</td>
<td>8</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>2008</td>
<td>2627.976562</td>
<td>0.083352</td>
<td>1063.593872</td>
<td>2008-08-27</td>
<td>2008-06-28</td>
<td>2008-10-03</td>
<td>-60 days</td>
<td>-97 days</td>
<td>9</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>2018</td>
<td>2547.906250</td>
<td>0.165637</td>
<td>1157.043457</td>
<td>2018-09-28</td>
<td>2018-09-12</td>
<td>2018-09-16</td>
<td>-16 days</td>
<td>-4 days</td>
<td>10</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>2011</td>
<td>2461.625000</td>
<td>0.080652</td>
<td>778.979004</td>
<td>2011-09-14</td>
<td>2011-09-21</td>
<td>2011-10-18</td>
<td>7 days</td>
<td>-27 days</td>
<td>11</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>2019</td>
<td>2440.054688</td>
<td>0.147553</td>
<td>1212.237061</td>
<td>2019-10-11</td>
<td>2019-10-30</td>
<td>2019-10-27</td>
<td>19 days</td>
<td>3 days</td>
<td>12</td>
<td>...</td>
<td>NaT</td>
<td>2019-10-27</td>
<td>NaT</td>
<td>2019-10-27</td>
<td>3 days</td>
<td>3 days</td>
<td>NaT</td>
<td>NaT</td>
<td>5.4</td>
<td>5.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>2001</td>
<td>2399.468750</td>
<td>0.061692</td>
<td>1064.437988</td>
<td>2001-09-20</td>
<td>2001-09-17</td>
<td>2001-10-04</td>
<td>-3 days</td>
<td>-17 days</td>
<td>13</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>2023</td>
<td>2379.328125</td>
<td>0.203958</td>
<td>900.323486</td>
<td>2023-08-26</td>
<td>2023-10-09</td>
<td>2023-10-07</td>
<td>44 days</td>
<td>2 days</td>
<td>14</td>
<td>...</td>
<td>2023-10-07</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>2016</td>
<td>2364.773438</td>
<td>0.118837</td>
<td>969.453369</td>
<td>2016-09-22</td>
<td>2016-09-25</td>
<td>2016-10-09</td>
<td>3 days</td>
<td>-14 days</td>
<td>15</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>2021</td>
<td>2253.296875</td>
<td>0.134848</td>
<td>676.297546</td>
<td>2021-07-09</td>
<td>2021-08-29</td>
<td>2021-09-05</td>
<td>51 days</td>
<td>-7 days</td>
<td>16</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>2007</td>
<td>2235.781250</td>
<td>0.103586</td>
<td>836.369751</td>
<td>2007-09-22</td>
<td>2007-09-12</td>
<td>2007-09-11</td>
<td>-10 days</td>
<td>1 days</td>
<td>17</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>2009</td>
<td>2169.906250</td>
<td>0.103484</td>
<td>766.465027</td>
<td>2009-09-05</td>
<td>2009-09-08</td>
<td>2009-09-10</td>
<td>3 days</td>
<td>-2 days</td>
<td>18</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>2005</td>
<td>2077.328125</td>
<td>0.082421</td>
<td>903.818298</td>
<td>2005-08-15</td>
<td>2005-08-23</td>
<td>2005-10-07</td>
<td>8 days</td>
<td>-45 days</td>
<td>19</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22</td>
<td>2020</td>
<td>1946.828125</td>
<td>0.087079</td>
<td>901.907959</td>
<td>2020-09-30</td>
<td>2020-10-05</td>
<td>2020-10-05</td>
<td>5 days</td>
<td>0 days</td>
<td>20</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2004</td>
<td>1856.578125</td>
<td>0.035491</td>
<td>801.753296</td>
<td>2004-09-07</td>
<td>2004-09-11</td>
<td>2004-09-26</td>
<td>4 days</td>
<td>-15 days</td>
<td>21</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>2002</td>
<td>1854.218750</td>
<td>0.093438</td>
<td>956.879333</td>
<td>2002-09-19</td>
<td>2002-09-24</td>
<td>2002-09-16</td>
<td>5 days</td>
<td>8 days</td>
<td>22</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>2006</td>
<td>1733.757812</td>
<td>0.113096</td>
<td>847.273560</td>
<td>2006-09-23</td>
<td>2006-09-16</td>
<td>2006-09-17</td>
<td>-7 days</td>
<td>-1 days</td>
<td>23</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>2017</td>
<td>1717.898438</td>
<td>0.088970</td>
<td>952.680115</td>
<td>2017-08-22</td>
<td>2017-08-19</td>
<td>2017-09-26</td>
<td>-3 days</td>
<td>-38 days</td>
<td>24</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>2013</td>
<td>1611.937500</td>
<td>0.092912</td>
<td>775.987488</td>
<td>2013-08-28</td>
<td>2013-09-02</td>
<td>2013-09-07</td>
<td>5 days</td>
<td>-5 days</td>
<td>25</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>2015</td>
<td>1563.804688</td>
<td>0.206910</td>
<td>738.006592</td>
<td>2015-09-20</td>
<td>2015-09-05</td>
<td>2015-10-12</td>
<td>-15 days</td>
<td>-37 days</td>
<td>26</td>
<td>...</td>
<td>2015-09-04</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>26 rows × 30 columns</p>
</div>
</div>
</div>
<div id="4e45c624-4f93-44f4-a2a9-f83a7f9399c9" class="cell" data-execution_count="43">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>df_selected_trigger.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>Index(['year', 'dis24', 'SFED', 'streamflow', 'dis24_maxdate', 'SFED_maxdate',
       'streamflow_maxdate', 'dis24_peak_leadtime', 'streamflow_peak_leadtime',
       'dis24_rank', 'dis24_rp', 'SFED_rank', 'SFED_rp', 'streamflow_rank',
       'streamflow_rp', '3yr_target', '4yr_target', '5yr_target',
       'SFED_3yr_thresh_date', 'SFED_4yr_thresh_date', 'SFED_5yr_thresh_date',
       'trig_date', 'dis24_trig_date', 'streamflow_trig_date', 'leadtime_peak',
       'leadtime_3yr_target', 'leadtime_4yr_target', 'leadtime_5yr_target',
       'rp_gf', 'rp_gr'],
      dtype='object')</code></pre>
</div>
</div>
<div id="925c1944-b4dd-4a59-902a-db71b1e7ac2d" class="cell" data-scrolled="true" data-execution_count="44">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>df_selected_trigger.sort_values(<span class="st">"streamflow"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="44">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">dis24</th>
<th data-quarto-table-cell-role="th">SFED</th>
<th data-quarto-table-cell-role="th">streamflow</th>
<th data-quarto-table-cell-role="th">dis24_maxdate</th>
<th data-quarto-table-cell-role="th">SFED_maxdate</th>
<th data-quarto-table-cell-role="th">streamflow_maxdate</th>
<th data-quarto-table-cell-role="th">dis24_peak_leadtime</th>
<th data-quarto-table-cell-role="th">streamflow_peak_leadtime</th>
<th data-quarto-table-cell-role="th">dis24_rank</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">SFED_5yr_thresh_date</th>
<th data-quarto-table-cell-role="th">trig_date</th>
<th data-quarto-table-cell-role="th">dis24_trig_date</th>
<th data-quarto-table-cell-role="th">streamflow_trig_date</th>
<th data-quarto-table-cell-role="th">leadtime_peak</th>
<th data-quarto-table-cell-role="th">leadtime_3yr_target</th>
<th data-quarto-table-cell-role="th">leadtime_4yr_target</th>
<th data-quarto-table-cell-role="th">leadtime_5yr_target</th>
<th data-quarto-table-cell-role="th">rp_gf</th>
<th data-quarto-table-cell-role="th">rp_gr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>2022</td>
<td>5347.171875</td>
<td>0.269161</td>
<td>1793.780396</td>
<td>2022-08-19</td>
<td>2022-09-21</td>
<td>2022-09-24</td>
<td>33 days</td>
<td>-3 days</td>
<td>1</td>
<td>...</td>
<td>2022-09-10</td>
<td>2022-08-19</td>
<td>2022-08-19</td>
<td>2022-09-04</td>
<td>33 days</td>
<td>8 days</td>
<td>10 days</td>
<td>22 days</td>
<td>5.4</td>
<td>5.4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1999</td>
<td>5244.656250</td>
<td>0.192214</td>
<td>1545.005493</td>
<td>1999-09-11</td>
<td>1999-10-21</td>
<td>1999-10-17</td>
<td>40 days</td>
<td>4 days</td>
<td>2</td>
<td>...</td>
<td>1999-10-21</td>
<td>1999-09-05</td>
<td>1999-09-05</td>
<td>1999-09-10</td>
<td>46 days</td>
<td>27 days</td>
<td>43 days</td>
<td>46 days</td>
<td>5.4</td>
<td>5.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>2012</td>
<td>3110.078125</td>
<td>0.286909</td>
<td>1394.855469</td>
<td>2012-08-21</td>
<td>2012-09-21</td>
<td>2012-09-23</td>
<td>31 days</td>
<td>-2 days</td>
<td>5</td>
<td>...</td>
<td>2012-08-27</td>
<td>2012-08-21</td>
<td>2012-08-21</td>
<td>2012-09-02</td>
<td>31 days</td>
<td>2 days</td>
<td>5 days</td>
<td>6 days</td>
<td>5.4</td>
<td>5.4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>1998</td>
<td>4300.250000</td>
<td>0.142014</td>
<td>1328.853149</td>
<td>1998-09-03</td>
<td>1998-09-29</td>
<td>1998-10-06</td>
<td>26 days</td>
<td>-7 days</td>
<td>3</td>
<td>...</td>
<td>NaT</td>
<td>1998-08-19</td>
<td>1998-08-19</td>
<td>1998-09-28</td>
<td>41 days</td>
<td>41 days</td>
<td>NaT</td>
<td>NaT</td>
<td>5.4</td>
<td>5.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>2019</td>
<td>2440.054688</td>
<td>0.147553</td>
<td>1212.237061</td>
<td>2019-10-11</td>
<td>2019-10-30</td>
<td>2019-10-27</td>
<td>19 days</td>
<td>3 days</td>
<td>12</td>
<td>...</td>
<td>NaT</td>
<td>2019-10-27</td>
<td>NaT</td>
<td>2019-10-27</td>
<td>3 days</td>
<td>3 days</td>
<td>NaT</td>
<td>NaT</td>
<td>5.4</td>
<td>5.4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>2018</td>
<td>2547.906250</td>
<td>0.165637</td>
<td>1157.043457</td>
<td>2018-09-28</td>
<td>2018-09-12</td>
<td>2018-09-16</td>
<td>-16 days</td>
<td>-4 days</td>
<td>10</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>2010</td>
<td>3109.257812</td>
<td>0.115183</td>
<td>1100.995361</td>
<td>2010-09-07</td>
<td>2010-09-10</td>
<td>2010-10-01</td>
<td>3 days</td>
<td>-21 days</td>
<td>6</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2001</td>
<td>2399.468750</td>
<td>0.061692</td>
<td>1064.437988</td>
<td>2001-09-20</td>
<td>2001-09-17</td>
<td>2001-10-04</td>
<td>-3 days</td>
<td>-17 days</td>
<td>13</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>2008</td>
<td>2627.976562</td>
<td>0.083352</td>
<td>1063.593872</td>
<td>2008-08-27</td>
<td>2008-06-28</td>
<td>2008-10-03</td>
<td>-60 days</td>
<td>-97 days</td>
<td>9</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18</td>
<td>2016</td>
<td>2364.773438</td>
<td>0.118837</td>
<td>969.453369</td>
<td>2016-09-22</td>
<td>2016-09-25</td>
<td>2016-10-09</td>
<td>3 days</td>
<td>-14 days</td>
<td>15</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2002</td>
<td>1854.218750</td>
<td>0.093438</td>
<td>956.879333</td>
<td>2002-09-19</td>
<td>2002-09-24</td>
<td>2002-09-16</td>
<td>5 days</td>
<td>8 days</td>
<td>22</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2003</td>
<td>3312.015625</td>
<td>0.151862</td>
<td>953.153015</td>
<td>2003-09-19</td>
<td>2003-09-21</td>
<td>2003-09-30</td>
<td>2 days</td>
<td>-9 days</td>
<td>4</td>
<td>...</td>
<td>NaT</td>
<td>2003-09-19</td>
<td>2003-09-19</td>
<td>NaT</td>
<td>2 days</td>
<td>1 days</td>
<td>NaT</td>
<td>NaT</td>
<td>5.4</td>
<td>5.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19</td>
<td>2017</td>
<td>1717.898438</td>
<td>0.088970</td>
<td>952.680115</td>
<td>2017-08-22</td>
<td>2017-08-19</td>
<td>2017-09-26</td>
<td>-3 days</td>
<td>-38 days</td>
<td>24</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>2014</td>
<td>2918.125000</td>
<td>0.100249</td>
<td>926.234802</td>
<td>2014-08-23</td>
<td>2014-08-31</td>
<td>2014-10-06</td>
<td>8 days</td>
<td>-36 days</td>
<td>7</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>2005</td>
<td>2077.328125</td>
<td>0.082421</td>
<td>903.818298</td>
<td>2005-08-15</td>
<td>2005-08-23</td>
<td>2005-10-07</td>
<td>8 days</td>
<td>-45 days</td>
<td>19</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22</td>
<td>2020</td>
<td>1946.828125</td>
<td>0.087079</td>
<td>901.907959</td>
<td>2020-09-30</td>
<td>2020-10-05</td>
<td>2020-10-05</td>
<td>5 days</td>
<td>0 days</td>
<td>20</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25</td>
<td>2023</td>
<td>2379.328125</td>
<td>0.203958</td>
<td>900.323486</td>
<td>2023-08-26</td>
<td>2023-10-09</td>
<td>2023-10-07</td>
<td>44 days</td>
<td>2 days</td>
<td>14</td>
<td>...</td>
<td>2023-10-07</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>2006</td>
<td>1733.757812</td>
<td>0.113096</td>
<td>847.273560</td>
<td>2006-09-23</td>
<td>2006-09-16</td>
<td>2006-09-17</td>
<td>-7 days</td>
<td>-1 days</td>
<td>23</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>2007</td>
<td>2235.781250</td>
<td>0.103586</td>
<td>836.369751</td>
<td>2007-09-22</td>
<td>2007-09-12</td>
<td>2007-09-11</td>
<td>-10 days</td>
<td>1 days</td>
<td>17</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>2004</td>
<td>1856.578125</td>
<td>0.035491</td>
<td>801.753296</td>
<td>2004-09-07</td>
<td>2004-09-11</td>
<td>2004-09-26</td>
<td>4 days</td>
<td>-15 days</td>
<td>21</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>2011</td>
<td>2461.625000</td>
<td>0.080652</td>
<td>778.979004</td>
<td>2011-09-14</td>
<td>2011-09-21</td>
<td>2011-10-18</td>
<td>7 days</td>
<td>-27 days</td>
<td>11</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>2013</td>
<td>1611.937500</td>
<td>0.092912</td>
<td>775.987488</td>
<td>2013-08-28</td>
<td>2013-09-02</td>
<td>2013-09-07</td>
<td>5 days</td>
<td>-5 days</td>
<td>25</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>2009</td>
<td>2169.906250</td>
<td>0.103484</td>
<td>766.465027</td>
<td>2009-09-05</td>
<td>2009-09-08</td>
<td>2009-09-10</td>
<td>3 days</td>
<td>-2 days</td>
<td>18</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>2000</td>
<td>2863.234375</td>
<td>0.112231</td>
<td>762.573181</td>
<td>2000-09-07</td>
<td>2000-09-02</td>
<td>2000-10-06</td>
<td>-5 days</td>
<td>-34 days</td>
<td>8</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>2015</td>
<td>1563.804688</td>
<td>0.206910</td>
<td>738.006592</td>
<td>2015-09-20</td>
<td>2015-09-05</td>
<td>2015-10-12</td>
<td>-15 days</td>
<td>-37 days</td>
<td>26</td>
<td>...</td>
<td>2015-09-04</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>2021</td>
<td>2253.296875</td>
<td>0.134848</td>
<td>676.297546</td>
<td>2021-07-09</td>
<td>2021-08-29</td>
<td>2021-09-05</td>
<td>51 days</td>
<td>-7 days</td>
<td>16</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>26 rows × 30 columns</p>
</div>
</div>
</div>
<div id="00cfcf23-33a9-425c-9e2e-ce9b72f5bcb3" class="cell" data-execution_count="45">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> [<span class="st">"dis24"</span>, <span class="st">"streamflow"</span>]:</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    thresh <span class="op">=</span> df_selected_trigger[</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>        <span class="op">~</span>df_selected_trigger[<span class="ss">f"</span><span class="sc">{</span>x<span class="sc">}</span><span class="ss">_trig_date"</span>].isnull()</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    ][x].<span class="bu">min</span>()</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(x, thresh)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>dis24 3110.0781
streamflow 1212.237</code></pre>
</div>
</div>
<section id="true-positives" class="level3" data-number="12.4.1">
<h3 data-number="12.4.1" class="anchored" data-anchor-id="true-positives"><span class="header-section-number">12.4.1</span> True positives</h3>
<div id="bb10caa1-cca2-47b7-8579-9a4508a678c2" class="cell" data-scrolled="true" data-execution_count="46">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>dff <span class="op">=</span> df_selected_trigger[</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    (df_selected_trigger[<span class="ss">f"</span><span class="sc">{</span>rp_target<span class="sc">}</span><span class="ss">yr_target"</span>])</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>df_selected_trigger[<span class="st">"rp_gf"</span>].isnull())</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, row <span class="kw">in</span> dff.iterrows():</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(row)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>year                                       1999
dis24                                5244.65625
SFED                                   0.192214
streamflow                          1545.005493
dis24_maxdate               1999-09-11 00:00:00
SFED_maxdate                1999-10-21 00:00:00
streamflow_maxdate          1999-10-17 00:00:00
dis24_peak_leadtime            40 days 00:00:00
streamflow_peak_leadtime        4 days 00:00:00
dis24_rank                                    2
dis24_rp                                   13.5
SFED_rank                                     5
SFED_rp                                     5.4
streamflow_rank                               2
streamflow_rp                              13.5
3yr_target                                 True
4yr_target                                 True
5yr_target                                 True
SFED_3yr_thresh_date        1999-10-02 00:00:00
SFED_4yr_thresh_date        1999-10-18 00:00:00
SFED_5yr_thresh_date        1999-10-21 00:00:00
trig_date                   1999-09-05 00:00:00
dis24_trig_date             1999-09-05 00:00:00
streamflow_trig_date        1999-09-10 00:00:00
leadtime_peak                  46 days 00:00:00
leadtime_3yr_target            27 days 00:00:00
leadtime_4yr_target            43 days 00:00:00
leadtime_5yr_target            46 days 00:00:00
rp_gf                                       5.4
rp_gr                                       5.4
Name: 1, dtype: object

year                                       2012
dis24                               3110.078125
SFED                                   0.286909
streamflow                          1394.855469
dis24_maxdate               2012-08-21 00:00:00
SFED_maxdate                2012-09-21 00:00:00
streamflow_maxdate          2012-09-23 00:00:00
dis24_peak_leadtime            31 days 00:00:00
streamflow_peak_leadtime      -2 days +00:00:00
dis24_rank                                    5
dis24_rp                                    5.4
SFED_rank                                     1
SFED_rp                                    27.0
streamflow_rank                               3
streamflow_rp                               9.0
3yr_target                                 True
4yr_target                                 True
5yr_target                                 True
SFED_3yr_thresh_date        2012-08-23 00:00:00
SFED_4yr_thresh_date        2012-08-26 00:00:00
SFED_5yr_thresh_date        2012-08-27 00:00:00
trig_date                   2012-08-21 00:00:00
dis24_trig_date             2012-08-21 00:00:00
streamflow_trig_date        2012-09-02 00:00:00
leadtime_peak                  31 days 00:00:00
leadtime_3yr_target             2 days 00:00:00
leadtime_4yr_target             5 days 00:00:00
leadtime_5yr_target             6 days 00:00:00
rp_gf                                       5.4
rp_gr                                       5.4
Name: 14, dtype: object

year                                       2022
dis24                               5347.171875
SFED                                   0.269161
streamflow                          1793.780396
dis24_maxdate               2022-08-19 00:00:00
SFED_maxdate                2022-09-21 00:00:00
streamflow_maxdate          2022-09-24 00:00:00
dis24_peak_leadtime            33 days 00:00:00
streamflow_peak_leadtime      -3 days +00:00:00
dis24_rank                                    1
dis24_rp                                   27.0
SFED_rank                                     2
SFED_rp                                    13.5
streamflow_rank                               1
streamflow_rp                              27.0
3yr_target                                 True
4yr_target                                 True
5yr_target                                 True
SFED_3yr_thresh_date        2022-08-27 00:00:00
SFED_4yr_thresh_date        2022-08-29 00:00:00
SFED_5yr_thresh_date        2022-09-10 00:00:00
trig_date                   2022-08-19 00:00:00
dis24_trig_date             2022-08-19 00:00:00
streamflow_trig_date        2022-09-04 00:00:00
leadtime_peak                  33 days 00:00:00
leadtime_3yr_target             8 days 00:00:00
leadtime_4yr_target            10 days 00:00:00
leadtime_5yr_target            22 days 00:00:00
rp_gf                                       5.4
rp_gr                                       5.4
Name: 24, dtype: object
</code></pre>
</div>
</div>
</section>
<section id="false-positives" class="level3" data-number="12.4.2">
<h3 data-number="12.4.2" class="anchored" data-anchor-id="false-positives"><span class="header-section-number">12.4.2</span> False positives</h3>
<div id="01cb6017-25a5-4ae8-8243-981eca314b76" class="cell" data-scrolled="true" data-execution_count="47">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>dff <span class="op">=</span> df_selected_trigger[</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    (<span class="op">~</span>df_selected_trigger[<span class="ss">f"</span><span class="sc">{</span>rp_target<span class="sc">}</span><span class="ss">yr_target"</span>])</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>df_selected_trigger[<span class="st">"rp_gf"</span>].isnull())</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, row <span class="kw">in</span> dff.iterrows():</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(row)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>year                                       1998
dis24                                   4300.25
SFED                                   0.142014
streamflow                          1328.853149
dis24_maxdate               1998-09-03 00:00:00
SFED_maxdate                1998-09-29 00:00:00
streamflow_maxdate          1998-10-06 00:00:00
dis24_peak_leadtime            26 days 00:00:00
streamflow_peak_leadtime      -7 days +00:00:00
dis24_rank                                    3
dis24_rp                                    9.0
SFED_rank                                     9
SFED_rp                                     3.0
streamflow_rank                               4
streamflow_rp                              6.75
3yr_target                                 True
4yr_target                                False
5yr_target                                False
SFED_3yr_thresh_date        1998-09-29 00:00:00
SFED_4yr_thresh_date                        NaT
SFED_5yr_thresh_date                        NaT
trig_date                   1998-08-19 00:00:00
dis24_trig_date             1998-08-19 00:00:00
streamflow_trig_date        1998-09-28 00:00:00
leadtime_peak                  41 days 00:00:00
leadtime_3yr_target            41 days 00:00:00
leadtime_4yr_target                         NaT
leadtime_5yr_target                         NaT
rp_gf                                       5.4
rp_gr                                       5.4
Name: 0, dtype: object

year                                       2003
dis24                               3312.015625
SFED                                   0.151862
streamflow                           953.153015
dis24_maxdate               2003-09-19 00:00:00
SFED_maxdate                2003-09-21 00:00:00
streamflow_maxdate          2003-09-30 00:00:00
dis24_peak_leadtime             2 days 00:00:00
streamflow_peak_leadtime      -9 days +00:00:00
dis24_rank                                    4
dis24_rp                                   6.75
SFED_rank                                     7
SFED_rp                                3.857143
streamflow_rank                              12
streamflow_rp                              2.25
3yr_target                                 True
4yr_target                                False
5yr_target                                False
SFED_3yr_thresh_date        2003-09-20 00:00:00
SFED_4yr_thresh_date                        NaT
SFED_5yr_thresh_date                        NaT
trig_date                   2003-09-19 00:00:00
dis24_trig_date             2003-09-19 00:00:00
streamflow_trig_date                        NaT
leadtime_peak                   2 days 00:00:00
leadtime_3yr_target             1 days 00:00:00
leadtime_4yr_target                         NaT
leadtime_5yr_target                         NaT
rp_gf                                       5.4
rp_gr                                       5.4
Name: 5, dtype: object

year                                       2019
dis24                               2440.054688
SFED                                   0.147553
streamflow                          1212.237061
dis24_maxdate               2019-10-11 00:00:00
SFED_maxdate                2019-10-30 00:00:00
streamflow_maxdate          2019-10-27 00:00:00
dis24_peak_leadtime            19 days 00:00:00
streamflow_peak_leadtime        3 days 00:00:00
dis24_rank                                   12
dis24_rp                                   2.25
SFED_rank                                     8
SFED_rp                                   3.375
streamflow_rank                               5
streamflow_rp                               5.4
3yr_target                                 True
4yr_target                                False
5yr_target                                False
SFED_3yr_thresh_date        2019-10-30 00:00:00
SFED_4yr_thresh_date                        NaT
SFED_5yr_thresh_date                        NaT
trig_date                   2019-10-27 00:00:00
dis24_trig_date                             NaT
streamflow_trig_date        2019-10-27 00:00:00
leadtime_peak                   3 days 00:00:00
leadtime_3yr_target             3 days 00:00:00
leadtime_4yr_target                         NaT
leadtime_5yr_target                         NaT
rp_gf                                       5.4
rp_gr                                       5.4
Name: 21, dtype: object
</code></pre>
</div>
</div>
</section>
<section id="false-negatives" class="level3" data-number="12.4.3">
<h3 data-number="12.4.3" class="anchored" data-anchor-id="false-negatives"><span class="header-section-number">12.4.3</span> False negatives</h3>
<div id="0dcdcea3-14fa-4d0b-aa63-757d7c075ae2" class="cell" data-scrolled="true" data-execution_count="48">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>dff <span class="op">=</span> df_selected_trigger[</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    (df_selected_trigger[<span class="ss">f"</span><span class="sc">{</span>rp_target<span class="sc">}</span><span class="ss">yr_target"</span>])</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (df_selected_trigger[<span class="st">"rp_gf"</span>].isnull())</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, row <span class="kw">in</span> dff.iterrows():</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(row)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>year                                       2015
dis24                               1563.804688
SFED                                    0.20691
streamflow                           738.006592
dis24_maxdate               2015-09-20 00:00:00
SFED_maxdate                2015-09-05 00:00:00
streamflow_maxdate          2015-10-12 00:00:00
dis24_peak_leadtime          -15 days +00:00:00
streamflow_peak_leadtime     -37 days +00:00:00
dis24_rank                                   26
dis24_rp                               1.038462
SFED_rank                                     3
SFED_rp                                     9.0
streamflow_rank                              25
streamflow_rp                              1.08
3yr_target                                 True
4yr_target                                 True
5yr_target                                 True
SFED_3yr_thresh_date        2015-09-01 00:00:00
SFED_4yr_thresh_date        2015-09-02 00:00:00
SFED_5yr_thresh_date        2015-09-04 00:00:00
trig_date                                   NaT
dis24_trig_date                             NaT
streamflow_trig_date                        NaT
leadtime_peak                               NaT
leadtime_3yr_target                         NaT
leadtime_4yr_target                         NaT
leadtime_5yr_target                         NaT
rp_gf                                       NaN
rp_gr                                       NaN
Name: 17, dtype: object

year                                       2023
dis24                               2379.328125
SFED                                   0.203958
streamflow                           900.323486
dis24_maxdate               2023-08-26 00:00:00
SFED_maxdate                2023-10-09 00:00:00
streamflow_maxdate          2023-10-07 00:00:00
dis24_peak_leadtime            44 days 00:00:00
streamflow_peak_leadtime        2 days 00:00:00
dis24_rank                                   14
dis24_rp                               1.928571
SFED_rank                                     4
SFED_rp                                    6.75
streamflow_rank                              17
streamflow_rp                          1.588235
3yr_target                                 True
4yr_target                                 True
5yr_target                                 True
SFED_3yr_thresh_date        2023-10-06 00:00:00
SFED_4yr_thresh_date        2023-10-07 00:00:00
SFED_5yr_thresh_date        2023-10-07 00:00:00
trig_date                                   NaT
dis24_trig_date                             NaT
streamflow_trig_date                        NaT
leadtime_peak                               NaT
leadtime_3yr_target                         NaT
leadtime_4yr_target                         NaT
leadtime_5yr_target                         NaT
rp_gf                                       NaN
rp_gr                                       NaN
Name: 25, dtype: object
</code></pre>
</div>
</div>
</section>
<section id="true-negatives" class="level3" data-number="12.4.4">
<h3 data-number="12.4.4" class="anchored" data-anchor-id="true-negatives"><span class="header-section-number">12.4.4</span> True negatives</h3>
<div id="8553f55f-7179-43c4-9468-68b9513613ac" class="cell" data-scrolled="true" data-execution_count="49">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>dff <span class="op">=</span> df_selected_trigger[</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    (<span class="op">~</span>df_selected_trigger[<span class="ss">f"</span><span class="sc">{</span>rp_target<span class="sc">}</span><span class="ss">yr_target"</span>])</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (df_selected_trigger[<span class="st">"rp_gf"</span>].isnull())</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, row <span class="kw">in</span> dff.iterrows():</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(row)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>year                                       2000
dis24                               2863.234375
SFED                                   0.112231
streamflow                           762.573181
dis24_maxdate               2000-09-07 00:00:00
SFED_maxdate                2000-09-02 00:00:00
streamflow_maxdate          2000-10-06 00:00:00
dis24_peak_leadtime           -5 days +00:00:00
streamflow_peak_leadtime     -34 days +00:00:00
dis24_rank                                    8
dis24_rp                                  3.375
SFED_rank                                    14
SFED_rp                                1.928571
streamflow_rank                              24
streamflow_rp                             1.125
3yr_target                                False
4yr_target                                False
5yr_target                                False
SFED_3yr_thresh_date                        NaT
SFED_4yr_thresh_date                        NaT
SFED_5yr_thresh_date                        NaT
trig_date                                   NaT
dis24_trig_date                             NaT
streamflow_trig_date                        NaT
leadtime_peak                               NaT
leadtime_3yr_target                         NaT
leadtime_4yr_target                         NaT
leadtime_5yr_target                         NaT
rp_gf                                       NaN
rp_gr                                       NaN
Name: 2, dtype: object

year                                       2001
dis24                                2399.46875
SFED                                   0.061692
streamflow                          1064.437988
dis24_maxdate               2001-09-20 00:00:00
SFED_maxdate                2001-09-17 00:00:00
streamflow_maxdate          2001-10-04 00:00:00
dis24_peak_leadtime           -3 days +00:00:00
streamflow_peak_leadtime     -17 days +00:00:00
dis24_rank                                   13
dis24_rp                               2.076923
SFED_rank                                    25
SFED_rp                                    1.08
streamflow_rank                               8
streamflow_rp                             3.375
3yr_target                                False
4yr_target                                False
5yr_target                                False
SFED_3yr_thresh_date                        NaT
SFED_4yr_thresh_date                        NaT
SFED_5yr_thresh_date                        NaT
trig_date                                   NaT
dis24_trig_date                             NaT
streamflow_trig_date                        NaT
leadtime_peak                               NaT
leadtime_3yr_target                         NaT
leadtime_4yr_target                         NaT
leadtime_5yr_target                         NaT
rp_gf                                       NaN
rp_gr                                       NaN
Name: 3, dtype: object

year                                       2002
dis24                                1854.21875
SFED                                   0.093438
streamflow                           956.879333
dis24_maxdate               2002-09-19 00:00:00
SFED_maxdate                2002-09-24 00:00:00
streamflow_maxdate          2002-09-16 00:00:00
dis24_peak_leadtime             5 days 00:00:00
streamflow_peak_leadtime        8 days 00:00:00
dis24_rank                                   22
dis24_rp                               1.227273
SFED_rank                                    18
SFED_rp                                     1.5
streamflow_rank                              11
streamflow_rp                          2.454545
3yr_target                                False
4yr_target                                False
5yr_target                                False
SFED_3yr_thresh_date                        NaT
SFED_4yr_thresh_date                        NaT
SFED_5yr_thresh_date                        NaT
trig_date                                   NaT
dis24_trig_date                             NaT
streamflow_trig_date                        NaT
leadtime_peak                               NaT
leadtime_3yr_target                         NaT
leadtime_4yr_target                         NaT
leadtime_5yr_target                         NaT
rp_gf                                       NaN
rp_gr                                       NaN
Name: 4, dtype: object

year                                       2004
dis24                               1856.578125
SFED                                   0.035491
streamflow                           801.753296
dis24_maxdate               2004-09-07 00:00:00
SFED_maxdate                2004-09-11 00:00:00
streamflow_maxdate          2004-09-26 00:00:00
dis24_peak_leadtime             4 days 00:00:00
streamflow_peak_leadtime     -15 days +00:00:00
dis24_rank                                   21
dis24_rp                               1.285714
SFED_rank                                    26
SFED_rp                                1.038462
streamflow_rank                              20
streamflow_rp                              1.35
3yr_target                                False
4yr_target                                False
5yr_target                                False
SFED_3yr_thresh_date                        NaT
SFED_4yr_thresh_date                        NaT
SFED_5yr_thresh_date                        NaT
trig_date                                   NaT
dis24_trig_date                             NaT
streamflow_trig_date                        NaT
leadtime_peak                               NaT
leadtime_3yr_target                         NaT
leadtime_4yr_target                         NaT
leadtime_5yr_target                         NaT
rp_gf                                       NaN
rp_gr                                       NaN
Name: 6, dtype: object

year                                       2005
dis24                               2077.328125
SFED                                   0.082421
streamflow                           903.818298
dis24_maxdate               2005-08-15 00:00:00
SFED_maxdate                2005-08-23 00:00:00
streamflow_maxdate          2005-10-07 00:00:00
dis24_peak_leadtime             8 days 00:00:00
streamflow_peak_leadtime     -45 days +00:00:00
dis24_rank                                   19
dis24_rp                               1.421053
SFED_rank                                    23
SFED_rp                                1.173913
streamflow_rank                              15
streamflow_rp                               1.8
3yr_target                                False
4yr_target                                False
5yr_target                                False
SFED_3yr_thresh_date                        NaT
SFED_4yr_thresh_date                        NaT
SFED_5yr_thresh_date                        NaT
trig_date                                   NaT
dis24_trig_date                             NaT
streamflow_trig_date                        NaT
leadtime_peak                               NaT
leadtime_3yr_target                         NaT
leadtime_4yr_target                         NaT
leadtime_5yr_target                         NaT
rp_gf                                       NaN
rp_gr                                       NaN
Name: 7, dtype: object

year                                       2006
dis24                               1733.757812
SFED                                   0.113096
streamflow                            847.27356
dis24_maxdate               2006-09-23 00:00:00
SFED_maxdate                2006-09-16 00:00:00
streamflow_maxdate          2006-09-17 00:00:00
dis24_peak_leadtime           -7 days +00:00:00
streamflow_peak_leadtime      -1 days +00:00:00
dis24_rank                                   23
dis24_rp                               1.173913
SFED_rank                                    13
SFED_rp                                2.076923
streamflow_rank                              18
streamflow_rp                               1.5
3yr_target                                False
4yr_target                                False
5yr_target                                False
SFED_3yr_thresh_date                        NaT
SFED_4yr_thresh_date                        NaT
SFED_5yr_thresh_date                        NaT
trig_date                                   NaT
dis24_trig_date                             NaT
streamflow_trig_date                        NaT
leadtime_peak                               NaT
leadtime_3yr_target                         NaT
leadtime_4yr_target                         NaT
leadtime_5yr_target                         NaT
rp_gf                                       NaN
rp_gr                                       NaN
Name: 8, dtype: object

year                                       2007
dis24                                2235.78125
SFED                                   0.103586
streamflow                           836.369751
dis24_maxdate               2007-09-22 00:00:00
SFED_maxdate                2007-09-12 00:00:00
streamflow_maxdate          2007-09-11 00:00:00
dis24_peak_leadtime          -10 days +00:00:00
streamflow_peak_leadtime        1 days 00:00:00
dis24_rank                                   17
dis24_rp                               1.588235
SFED_rank                                    15
SFED_rp                                     1.8
streamflow_rank                              19
streamflow_rp                          1.421053
3yr_target                                False
4yr_target                                False
5yr_target                                False
SFED_3yr_thresh_date                        NaT
SFED_4yr_thresh_date                        NaT
SFED_5yr_thresh_date                        NaT
trig_date                                   NaT
dis24_trig_date                             NaT
streamflow_trig_date                        NaT
leadtime_peak                               NaT
leadtime_3yr_target                         NaT
leadtime_4yr_target                         NaT
leadtime_5yr_target                         NaT
rp_gf                                       NaN
rp_gr                                       NaN
Name: 9, dtype: object

year                                       2008
dis24                               2627.976562
SFED                                   0.083352
streamflow                          1063.593872
dis24_maxdate               2008-08-27 00:00:00
SFED_maxdate                2008-06-28 00:00:00
streamflow_maxdate          2008-10-03 00:00:00
dis24_peak_leadtime          -60 days +00:00:00
streamflow_peak_leadtime     -97 days +00:00:00
dis24_rank                                    9
dis24_rp                                    3.0
SFED_rank                                    22
SFED_rp                                1.227273
streamflow_rank                               9
streamflow_rp                               3.0
3yr_target                                False
4yr_target                                False
5yr_target                                False
SFED_3yr_thresh_date                        NaT
SFED_4yr_thresh_date                        NaT
SFED_5yr_thresh_date                        NaT
trig_date                                   NaT
dis24_trig_date                             NaT
streamflow_trig_date                        NaT
leadtime_peak                               NaT
leadtime_3yr_target                         NaT
leadtime_4yr_target                         NaT
leadtime_5yr_target                         NaT
rp_gf                                       NaN
rp_gr                                       NaN
Name: 10, dtype: object

year                                       2009
dis24                                2169.90625
SFED                                   0.103484
streamflow                           766.465027
dis24_maxdate               2009-09-05 00:00:00
SFED_maxdate                2009-09-08 00:00:00
streamflow_maxdate          2009-09-10 00:00:00
dis24_peak_leadtime             3 days 00:00:00
streamflow_peak_leadtime      -2 days +00:00:00
dis24_rank                                   18
dis24_rp                                    1.5
SFED_rank                                    16
SFED_rp                                  1.6875
streamflow_rank                              23
streamflow_rp                          1.173913
3yr_target                                False
4yr_target                                False
5yr_target                                False
SFED_3yr_thresh_date                        NaT
SFED_4yr_thresh_date                        NaT
SFED_5yr_thresh_date                        NaT
trig_date                                   NaT
dis24_trig_date                             NaT
streamflow_trig_date                        NaT
leadtime_peak                               NaT
leadtime_3yr_target                         NaT
leadtime_4yr_target                         NaT
leadtime_5yr_target                         NaT
rp_gf                                       NaN
rp_gr                                       NaN
Name: 11, dtype: object

year                                       2010
dis24                               3109.257812
SFED                                   0.115183
streamflow                          1100.995361
dis24_maxdate               2010-09-07 00:00:00
SFED_maxdate                2010-09-10 00:00:00
streamflow_maxdate          2010-10-01 00:00:00
dis24_peak_leadtime             3 days 00:00:00
streamflow_peak_leadtime     -21 days +00:00:00
dis24_rank                                    6
dis24_rp                                    4.5
SFED_rank                                    12
SFED_rp                                    2.25
streamflow_rank                               7
streamflow_rp                          3.857143
3yr_target                                False
4yr_target                                False
5yr_target                                False
SFED_3yr_thresh_date                        NaT
SFED_4yr_thresh_date                        NaT
SFED_5yr_thresh_date                        NaT
trig_date                                   NaT
dis24_trig_date                             NaT
streamflow_trig_date                        NaT
leadtime_peak                               NaT
leadtime_3yr_target                         NaT
leadtime_4yr_target                         NaT
leadtime_5yr_target                         NaT
rp_gf                                       NaN
rp_gr                                       NaN
Name: 12, dtype: object

year                                       2011
dis24                                  2461.625
SFED                                   0.080652
streamflow                           778.979004
dis24_maxdate               2011-09-14 00:00:00
SFED_maxdate                2011-09-21 00:00:00
streamflow_maxdate          2011-10-18 00:00:00
dis24_peak_leadtime             7 days 00:00:00
streamflow_peak_leadtime     -27 days +00:00:00
dis24_rank                                   11
dis24_rp                               2.454545
SFED_rank                                    24
SFED_rp                                   1.125
streamflow_rank                              21
streamflow_rp                          1.285714
3yr_target                                False
4yr_target                                False
5yr_target                                False
SFED_3yr_thresh_date                        NaT
SFED_4yr_thresh_date                        NaT
SFED_5yr_thresh_date                        NaT
trig_date                                   NaT
dis24_trig_date                             NaT
streamflow_trig_date                        NaT
leadtime_peak                               NaT
leadtime_3yr_target                         NaT
leadtime_4yr_target                         NaT
leadtime_5yr_target                         NaT
rp_gf                                       NaN
rp_gr                                       NaN
Name: 13, dtype: object

year                                       2013
dis24                                 1611.9375
SFED                                   0.092912
streamflow                           775.987488
dis24_maxdate               2013-08-28 00:00:00
SFED_maxdate                2013-09-02 00:00:00
streamflow_maxdate          2013-09-07 00:00:00
dis24_peak_leadtime             5 days 00:00:00
streamflow_peak_leadtime      -5 days +00:00:00
dis24_rank                                   25
dis24_rp                                   1.08
SFED_rank                                    19
SFED_rp                                1.421053
streamflow_rank                              22
streamflow_rp                          1.227273
3yr_target                                False
4yr_target                                False
5yr_target                                False
SFED_3yr_thresh_date                        NaT
SFED_4yr_thresh_date                        NaT
SFED_5yr_thresh_date                        NaT
trig_date                                   NaT
dis24_trig_date                             NaT
streamflow_trig_date                        NaT
leadtime_peak                               NaT
leadtime_3yr_target                         NaT
leadtime_4yr_target                         NaT
leadtime_5yr_target                         NaT
rp_gf                                       NaN
rp_gr                                       NaN
Name: 15, dtype: object

year                                       2014
dis24                                  2918.125
SFED                                   0.100249
streamflow                           926.234802
dis24_maxdate               2014-08-23 00:00:00
SFED_maxdate                2014-08-31 00:00:00
streamflow_maxdate          2014-10-06 00:00:00
dis24_peak_leadtime             8 days 00:00:00
streamflow_peak_leadtime     -36 days +00:00:00
dis24_rank                                    7
dis24_rp                               3.857143
SFED_rank                                    17
SFED_rp                                1.588235
streamflow_rank                              14
streamflow_rp                          1.928571
3yr_target                                False
4yr_target                                False
5yr_target                                False
SFED_3yr_thresh_date                        NaT
SFED_4yr_thresh_date                        NaT
SFED_5yr_thresh_date                        NaT
trig_date                                   NaT
dis24_trig_date                             NaT
streamflow_trig_date                        NaT
leadtime_peak                               NaT
leadtime_3yr_target                         NaT
leadtime_4yr_target                         NaT
leadtime_5yr_target                         NaT
rp_gf                                       NaN
rp_gr                                       NaN
Name: 16, dtype: object

year                                       2016
dis24                               2364.773438
SFED                                   0.118837
streamflow                           969.453369
dis24_maxdate               2016-09-22 00:00:00
SFED_maxdate                2016-09-25 00:00:00
streamflow_maxdate          2016-10-09 00:00:00
dis24_peak_leadtime             3 days 00:00:00
streamflow_peak_leadtime     -14 days +00:00:00
dis24_rank                                   15
dis24_rp                                    1.8
SFED_rank                                    11
SFED_rp                                2.454545
streamflow_rank                              10
streamflow_rp                               2.7
3yr_target                                False
4yr_target                                False
5yr_target                                False
SFED_3yr_thresh_date                        NaT
SFED_4yr_thresh_date                        NaT
SFED_5yr_thresh_date                        NaT
trig_date                                   NaT
dis24_trig_date                             NaT
streamflow_trig_date                        NaT
leadtime_peak                               NaT
leadtime_3yr_target                         NaT
leadtime_4yr_target                         NaT
leadtime_5yr_target                         NaT
rp_gf                                       NaN
rp_gr                                       NaN
Name: 18, dtype: object

year                                       2017
dis24                               1717.898438
SFED                                    0.08897
streamflow                           952.680115
dis24_maxdate               2017-08-22 00:00:00
SFED_maxdate                2017-08-19 00:00:00
streamflow_maxdate          2017-09-26 00:00:00
dis24_peak_leadtime           -3 days +00:00:00
streamflow_peak_leadtime     -38 days +00:00:00
dis24_rank                                   24
dis24_rp                                  1.125
SFED_rank                                    20
SFED_rp                                    1.35
streamflow_rank                              13
streamflow_rp                          2.076923
3yr_target                                False
4yr_target                                False
5yr_target                                False
SFED_3yr_thresh_date                        NaT
SFED_4yr_thresh_date                        NaT
SFED_5yr_thresh_date                        NaT
trig_date                                   NaT
dis24_trig_date                             NaT
streamflow_trig_date                        NaT
leadtime_peak                               NaT
leadtime_3yr_target                         NaT
leadtime_4yr_target                         NaT
leadtime_5yr_target                         NaT
rp_gf                                       NaN
rp_gr                                       NaN
Name: 19, dtype: object

year                                       2018
dis24                                2547.90625
SFED                                   0.165637
streamflow                          1157.043457
dis24_maxdate               2018-09-28 00:00:00
SFED_maxdate                2018-09-12 00:00:00
streamflow_maxdate          2018-09-16 00:00:00
dis24_peak_leadtime          -16 days +00:00:00
streamflow_peak_leadtime      -4 days +00:00:00
dis24_rank                                   10
dis24_rp                                    2.7
SFED_rank                                     6
SFED_rp                                     4.5
streamflow_rank                               6
streamflow_rp                               4.5
3yr_target                                 True
4yr_target                                 True
5yr_target                                False
SFED_3yr_thresh_date        2018-08-29 00:00:00
SFED_4yr_thresh_date        2018-09-12 00:00:00
SFED_5yr_thresh_date                        NaT
trig_date                                   NaT
dis24_trig_date                             NaT
streamflow_trig_date                        NaT
leadtime_peak                               NaT
leadtime_3yr_target                         NaT
leadtime_4yr_target                         NaT
leadtime_5yr_target                         NaT
rp_gf                                       NaN
rp_gr                                       NaN
Name: 20, dtype: object

year                                       2020
dis24                               1946.828125
SFED                                   0.087079
streamflow                           901.907959
dis24_maxdate               2020-09-30 00:00:00
SFED_maxdate                2020-10-05 00:00:00
streamflow_maxdate          2020-10-05 00:00:00
dis24_peak_leadtime             5 days 00:00:00
streamflow_peak_leadtime        0 days 00:00:00
dis24_rank                                   20
dis24_rp                                   1.35
SFED_rank                                    21
SFED_rp                                1.285714
streamflow_rank                              16
streamflow_rp                            1.6875
3yr_target                                False
4yr_target                                False
5yr_target                                False
SFED_3yr_thresh_date                        NaT
SFED_4yr_thresh_date                        NaT
SFED_5yr_thresh_date                        NaT
trig_date                                   NaT
dis24_trig_date                             NaT
streamflow_trig_date                        NaT
leadtime_peak                               NaT
leadtime_3yr_target                         NaT
leadtime_4yr_target                         NaT
leadtime_5yr_target                         NaT
rp_gf                                       NaN
rp_gr                                       NaN
Name: 22, dtype: object

year                                       2021
dis24                               2253.296875
SFED                                   0.134848
streamflow                           676.297546
dis24_maxdate               2021-07-09 00:00:00
SFED_maxdate                2021-08-29 00:00:00
streamflow_maxdate          2021-09-05 00:00:00
dis24_peak_leadtime            51 days 00:00:00
streamflow_peak_leadtime      -7 days +00:00:00
dis24_rank                                   16
dis24_rp                                 1.6875
SFED_rank                                    10
SFED_rp                                     2.7
streamflow_rank                              26
streamflow_rp                          1.038462
3yr_target                                False
4yr_target                                False
5yr_target                                False
SFED_3yr_thresh_date                        NaT
SFED_4yr_thresh_date                        NaT
SFED_5yr_thresh_date                        NaT
trig_date                                   NaT
dis24_trig_date                             NaT
streamflow_trig_date                        NaT
leadtime_peak                               NaT
leadtime_3yr_target                         NaT
leadtime_4yr_target                         NaT
leadtime_5yr_target                         NaT
rp_gf                                       NaN
rp_gr                                       NaN
Name: 23, dtype: object
</code></pre>
</div>
</div>
</section>
<section id="timeline" class="level3" data-number="12.4.5">
<h3 data-number="12.4.5" class="anchored" data-anchor-id="timeline"><span class="header-section-number">12.4.5</span> Timeline</h3>
<p>Plot historical timing of trigger and flood extent severities.</p>
<p>First check average leadtimes of specific indicators:</p>
<div id="ac21b961-c637-4949-bb5f-8c4200d0611e" class="cell" data-execution_count="50">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>df_selected_trigger[<span class="st">"dis24_5yr_leadtime"</span>] <span class="op">=</span> (</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    df_selected_trigger[<span class="st">"SFED_5yr_thresh_date"</span>]</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> df_selected_trigger[<span class="st">"dis24_trig_date"</span>]</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="a267a881-1295-4c27-a871-31d084c77b91" class="cell" data-execution_count="51">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>df_selected_trigger[<span class="st">"dis24_5yr_leadtime"</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>Timedelta('24 days 16:00:00')</code></pre>
</div>
</div>
<div id="fe1d472e-fa60-4500-b0bf-2f81fcc1268a" class="cell" data-execution_count="52">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>df_selected_trigger[<span class="st">"streamflow_5yr_leadtime"</span>] <span class="op">=</span> (</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    df_selected_trigger[<span class="st">"SFED_5yr_thresh_date"</span>]</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> df_selected_trigger[<span class="st">"streamflow_trig_date"</span>]</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="9291cf87-4514-44eb-862c-3e76b427c5b2" class="cell" data-execution_count="53">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>df_selected_trigger[<span class="st">"streamflow_5yr_leadtime"</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>Timedelta('13 days 16:00:00')</code></pre>
</div>
</div>
<div id="e20c759f-6c15-4f23-87bc-3b4f771d44ba" class="cell" data-execution_count="54">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>df_selected_trigger[<span class="st">"leadtime_5yr_target"</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>Timedelta('24 days 16:00:00')</code></pre>
</div>
</div>
<p>Create plot showing when each year both triggers would have been met, and when flood extent reached 3-, 4-, and 5-yr RP severity, as well as yearly maximum.</p>
<div id="40615340-afa9-41b1-88eb-ddff271159e2" class="cell" data-execution_count="55">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>df_plot <span class="op">=</span> df_selected_trigger.copy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="a95ca4c0-b3be-4db0-be9a-1a6621cd7020" class="cell" data-execution_count="56">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure datetime format</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>date_cols <span class="op">=</span> [</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"trig_date"</span>,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dis24_trig_date"</span>,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"streamflow_trig_date"</span>,</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SFED_3yr_thresh_date"</span>,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SFED_4yr_thresh_date"</span>,</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SFED_5yr_thresh_date"</span>,</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SFED_maxdate"</span>,</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co"># df_plot[date_cols] = df_plot[date_cols].apply(pd.to_datetime)</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize to fixed year for x-axis alignment</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_date(dt):</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pd.isnull(dt):</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dt.replace(year<span class="op">=</span><span class="dv">2000</span>)</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> date_cols:</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>    df_plot[<span class="ss">f"</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">_norm"</span>] <span class="op">=</span> df_plot[col].<span class="bu">apply</span>(normalize_date)</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Define full style config for each date column</span></span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Format: col_name -&gt; (color, label, marker, size, zorder, annotate_above_line)</span></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>date_styles <span class="op">=</span> {</span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"trig_date_norm"</span>: (<span class="st">"black"</span>, <span class="st">"Overall trigger"</span>, <span class="st">"|"</span>, <span class="dv">100</span>, <span class="op">-</span><span class="dv">2</span>, <span class="va">False</span>),</span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dis24_trig_date_norm"</span>: (</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">"dodgerblue"</span>,</span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">"GloFAS trigger"</span>,</span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">"|"</span>,</span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>        <span class="dv">50</span>,</span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>        <span class="dv">5</span>,</span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>        <span class="va">False</span>,</span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"streamflow_trig_date_norm"</span>: (</span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>        <span class="st">"green"</span>,</span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Google trigger"</span>,</span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>        <span class="st">"|"</span>,</span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a>        <span class="dv">50</span>,</span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a>        <span class="dv">5</span>,</span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a>        <span class="va">False</span>,</span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SFED_maxdate_norm"</span>: (<span class="st">"k"</span>, <span class="st">"Max. flood extent"</span>, <span class="st">"o"</span>, <span class="dv">10</span>, <span class="dv">4</span>, <span class="va">True</span>),</span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SFED_3yr_thresh_date_norm"</span>: (</span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a>        <span class="st">"darkorange"</span>,</span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a>        <span class="st">"3-yr RP flood extent"</span>,</span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true" tabindex="-1"></a>        <span class="st">"o"</span>,</span>
<span id="cb62-49"><a href="#cb62-49" aria-hidden="true" tabindex="-1"></a>        <span class="dv">40</span>,</span>
<span id="cb62-50"><a href="#cb62-50" aria-hidden="true" tabindex="-1"></a>        <span class="dv">4</span>,</span>
<span id="cb62-51"><a href="#cb62-51" aria-hidden="true" tabindex="-1"></a>        <span class="va">True</span>,</span>
<span id="cb62-52"><a href="#cb62-52" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-53"><a href="#cb62-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SFED_4yr_thresh_date_norm"</span>: (</span>
<span id="cb62-54"><a href="#cb62-54" aria-hidden="true" tabindex="-1"></a>        <span class="st">"crimson"</span>,</span>
<span id="cb62-55"><a href="#cb62-55" aria-hidden="true" tabindex="-1"></a>        <span class="st">"4-yr RP flood extent"</span>,</span>
<span id="cb62-56"><a href="#cb62-56" aria-hidden="true" tabindex="-1"></a>        <span class="st">"o"</span>,</span>
<span id="cb62-57"><a href="#cb62-57" aria-hidden="true" tabindex="-1"></a>        <span class="dv">70</span>,</span>
<span id="cb62-58"><a href="#cb62-58" aria-hidden="true" tabindex="-1"></a>        <span class="dv">4</span>,</span>
<span id="cb62-59"><a href="#cb62-59" aria-hidden="true" tabindex="-1"></a>        <span class="va">True</span>,</span>
<span id="cb62-60"><a href="#cb62-60" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-61"><a href="#cb62-61" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SFED_5yr_thresh_date_norm"</span>: (</span>
<span id="cb62-62"><a href="#cb62-62" aria-hidden="true" tabindex="-1"></a>        <span class="st">"purple"</span>,</span>
<span id="cb62-63"><a href="#cb62-63" aria-hidden="true" tabindex="-1"></a>        <span class="st">"5-yr RP flood extent"</span>,</span>
<span id="cb62-64"><a href="#cb62-64" aria-hidden="true" tabindex="-1"></a>        <span class="st">"o"</span>,</span>
<span id="cb62-65"><a href="#cb62-65" aria-hidden="true" tabindex="-1"></a>        <span class="dv">100</span>,</span>
<span id="cb62-66"><a href="#cb62-66" aria-hidden="true" tabindex="-1"></a>        <span class="dv">4</span>,</span>
<span id="cb62-67"><a href="#cb62-67" aria-hidden="true" tabindex="-1"></a>        <span class="va">True</span>,</span>
<span id="cb62-68"><a href="#cb62-68" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-69"><a href="#cb62-69" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-70"><a href="#cb62-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-71"><a href="#cb62-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup plot</span></span>
<span id="cb62-72"><a href="#cb62-72" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">10</span>), dpi<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb62-73"><a href="#cb62-73" aria-hidden="true" tabindex="-1"></a>years_sorted <span class="op">=</span> <span class="bu">sorted</span>(df_plot[<span class="st">"year"</span>].unique(), reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb62-74"><a href="#cb62-74" aria-hidden="true" tabindex="-1"></a>y_positions <span class="op">=</span> {year: i <span class="cf">for</span> i, year <span class="kw">in</span> <span class="bu">enumerate</span>(years_sorted)}</span>
<span id="cb62-75"><a href="#cb62-75" aria-hidden="true" tabindex="-1"></a>plotted_labels <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb62-76"><a href="#cb62-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-77"><a href="#cb62-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw timelines</span></span>
<span id="cb62-78"><a href="#cb62-78" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, row <span class="kw">in</span> df_plot.iterrows():</span>
<span id="cb62-79"><a href="#cb62-79" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> y_positions[row[<span class="st">"year"</span>]]</span>
<span id="cb62-80"><a href="#cb62-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-81"><a href="#cb62-81" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Horizontal baseline</span></span>
<span id="cb62-82"><a href="#cb62-82" aria-hidden="true" tabindex="-1"></a>    ax.hlines(</span>
<span id="cb62-83"><a href="#cb62-83" aria-hidden="true" tabindex="-1"></a>        y,</span>
<span id="cb62-84"><a href="#cb62-84" aria-hidden="true" tabindex="-1"></a>        pd.Timestamp(<span class="st">"2000-08-01"</span>),</span>
<span id="cb62-85"><a href="#cb62-85" aria-hidden="true" tabindex="-1"></a>        pd.Timestamp(<span class="st">"2000-11-01"</span>),</span>
<span id="cb62-86"><a href="#cb62-86" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">"lightgray"</span>,</span>
<span id="cb62-87"><a href="#cb62-87" aria-hidden="true" tabindex="-1"></a>        linewidth<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb62-88"><a href="#cb62-88" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-89"><a href="#cb62-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-90"><a href="#cb62-90" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot and annotate each date</span></span>
<span id="cb62-91"><a href="#cb62-91" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col_norm, (</span>
<span id="cb62-92"><a href="#cb62-92" aria-hidden="true" tabindex="-1"></a>        color,</span>
<span id="cb62-93"><a href="#cb62-93" aria-hidden="true" tabindex="-1"></a>        label,</span>
<span id="cb62-94"><a href="#cb62-94" aria-hidden="true" tabindex="-1"></a>        marker,</span>
<span id="cb62-95"><a href="#cb62-95" aria-hidden="true" tabindex="-1"></a>        size,</span>
<span id="cb62-96"><a href="#cb62-96" aria-hidden="true" tabindex="-1"></a>        zorder,</span>
<span id="cb62-97"><a href="#cb62-97" aria-hidden="true" tabindex="-1"></a>        annotate_above,</span>
<span id="cb62-98"><a href="#cb62-98" aria-hidden="true" tabindex="-1"></a>    ) <span class="kw">in</span> date_styles.items():</span>
<span id="cb62-99"><a href="#cb62-99" aria-hidden="true" tabindex="-1"></a>        date_val <span class="op">=</span> row.get(col_norm)</span>
<span id="cb62-100"><a href="#cb62-100" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pd.notnull(date_val):</span>
<span id="cb62-101"><a href="#cb62-101" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Plot marker</span></span>
<span id="cb62-102"><a href="#cb62-102" aria-hidden="true" tabindex="-1"></a>            show_label <span class="op">=</span> label <span class="cf">if</span> label <span class="kw">not</span> <span class="kw">in</span> plotted_labels <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb62-103"><a href="#cb62-103" aria-hidden="true" tabindex="-1"></a>            ax.scatter(</span>
<span id="cb62-104"><a href="#cb62-104" aria-hidden="true" tabindex="-1"></a>                date_val,</span>
<span id="cb62-105"><a href="#cb62-105" aria-hidden="true" tabindex="-1"></a>                y,</span>
<span id="cb62-106"><a href="#cb62-106" aria-hidden="true" tabindex="-1"></a>                facecolor<span class="op">=</span>color,</span>
<span id="cb62-107"><a href="#cb62-107" aria-hidden="true" tabindex="-1"></a>                edgecolor<span class="op">=</span><span class="st">"none"</span>,</span>
<span id="cb62-108"><a href="#cb62-108" aria-hidden="true" tabindex="-1"></a>                s<span class="op">=</span>size,</span>
<span id="cb62-109"><a href="#cb62-109" aria-hidden="true" tabindex="-1"></a>                marker<span class="op">=</span>marker,</span>
<span id="cb62-110"><a href="#cb62-110" aria-hidden="true" tabindex="-1"></a>                zorder<span class="op">=</span>zorder,</span>
<span id="cb62-111"><a href="#cb62-111" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span>show_label,</span>
<span id="cb62-112"><a href="#cb62-112" aria-hidden="true" tabindex="-1"></a>                alpha<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb62-113"><a href="#cb62-113" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb62-114"><a href="#cb62-114" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> show_label:</span>
<span id="cb62-115"><a href="#cb62-115" aria-hidden="true" tabindex="-1"></a>                plotted_labels.add(label)</span>
<span id="cb62-116"><a href="#cb62-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-117"><a href="#cb62-117" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Format label date</span></span>
<span id="cb62-118"><a href="#cb62-118" aria-hidden="true" tabindex="-1"></a>            label_text <span class="op">=</span> date_val.strftime(<span class="st">"%b </span><span class="sc">%d</span><span class="st">"</span>)</span>
<span id="cb62-119"><a href="#cb62-119" aria-hidden="true" tabindex="-1"></a>            offset <span class="op">=</span> <span class="fl">0.4</span> <span class="cf">if</span> annotate_above <span class="cf">else</span> <span class="op">-</span><span class="fl">0.4</span></span>
<span id="cb62-120"><a href="#cb62-120" aria-hidden="true" tabindex="-1"></a>            ax.annotate(</span>
<span id="cb62-121"><a href="#cb62-121" aria-hidden="true" tabindex="-1"></a>                label_text,</span>
<span id="cb62-122"><a href="#cb62-122" aria-hidden="true" tabindex="-1"></a>                (date_val, y <span class="op">+</span> offset),</span>
<span id="cb62-123"><a href="#cb62-123" aria-hidden="true" tabindex="-1"></a>                ha<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb62-124"><a href="#cb62-124" aria-hidden="true" tabindex="-1"></a>                va<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb62-125"><a href="#cb62-125" aria-hidden="true" tabindex="-1"></a>                fontsize<span class="op">=</span><span class="dv">8</span>,</span>
<span id="cb62-126"><a href="#cb62-126" aria-hidden="true" tabindex="-1"></a>                color<span class="op">=</span>color,</span>
<span id="cb62-127"><a href="#cb62-127" aria-hidden="true" tabindex="-1"></a>                alpha<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb62-128"><a href="#cb62-128" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb62-129"><a href="#cb62-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-130"><a href="#cb62-130" aria-hidden="true" tabindex="-1"></a><span class="co"># Add vertical lines for month boundaries</span></span>
<span id="cb62-131"><a href="#cb62-131" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> month_start <span class="kw">in</span> pd.date_range(<span class="st">"2000-08-01"</span>, <span class="st">"2000-11-01"</span>, freq<span class="op">=</span><span class="st">"MS"</span>):</span>
<span id="cb62-132"><a href="#cb62-132" aria-hidden="true" tabindex="-1"></a>    ax.axvline(month_start, color<span class="op">=</span><span class="st">"lightgray"</span>, linestyle<span class="op">=</span><span class="st">":"</span>, linewidth<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb62-133"><a href="#cb62-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-134"><a href="#cb62-134" aria-hidden="true" tabindex="-1"></a><span class="co"># Axes formatting</span></span>
<span id="cb62-135"><a href="#cb62-135" aria-hidden="true" tabindex="-1"></a>ax.set_yticks(<span class="bu">list</span>(y_positions.values()))</span>
<span id="cb62-136"><a href="#cb62-136" aria-hidden="true" tabindex="-1"></a>ax.set_yticklabels(<span class="bu">list</span>(y_positions.keys()))</span>
<span id="cb62-137"><a href="#cb62-137" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Year"</span>)</span>
<span id="cb62-138"><a href="#cb62-138" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Date"</span>)</span>
<span id="cb62-139"><a href="#cb62-139" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Historical trigger timing"</span>)</span>
<span id="cb62-140"><a href="#cb62-140" aria-hidden="true" tabindex="-1"></a>ax.invert_yaxis()</span>
<span id="cb62-141"><a href="#cb62-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-142"><a href="#cb62-142" aria-hidden="true" tabindex="-1"></a><span class="co"># X-axis date formatting</span></span>
<span id="cb62-143"><a href="#cb62-143" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(pd.Timestamp(<span class="st">"2000-08-01"</span>), pd.Timestamp(<span class="st">"2000-11-01"</span>))</span>
<span id="cb62-144"><a href="#cb62-144" aria-hidden="true" tabindex="-1"></a>ax.xaxis.set_major_formatter(mdates.DateFormatter(<span class="st">"%b </span><span class="sc">%d</span><span class="st">"</span>))</span>
<span id="cb62-145"><a href="#cb62-145" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.xaxis.set_major_locator(mdates.WeekdayLocator(interval=7))</span></span>
<span id="cb62-146"><a href="#cb62-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-147"><a href="#cb62-147" aria-hidden="true" tabindex="-1"></a><span class="co"># Legend</span></span>
<span id="cb62-148"><a href="#cb62-148" aria-hidden="true" tabindex="-1"></a>handles, labels <span class="op">=</span> ax.get_legend_handles_labels()</span>
<span id="cb62-149"><a href="#cb62-149" aria-hidden="true" tabindex="-1"></a>by_label <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(labels, handles))</span>
<span id="cb62-150"><a href="#cb62-150" aria-hidden="true" tabindex="-1"></a>ax.legend(</span>
<span id="cb62-151"><a href="#cb62-151" aria-hidden="true" tabindex="-1"></a>    by_label.values(),</span>
<span id="cb62-152"><a href="#cb62-152" aria-hidden="true" tabindex="-1"></a>    by_label.keys(),</span>
<span id="cb62-153"><a href="#cb62-153" aria-hidden="true" tabindex="-1"></a>    loc<span class="op">=</span><span class="st">"upper left"</span>,</span>
<span id="cb62-154"><a href="#cb62-154" aria-hidden="true" tabindex="-1"></a>    bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb62-155"><a href="#cb62-155" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-156"><a href="#cb62-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-157"><a href="#cb62-157" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb62-158"><a href="#cb62-158" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/66/764yc5p92nvdc_nm3xmy5rn40000gn/T/ipykernel_97399/795225929.py:103: UserWarning: You passed a edgecolor/edgecolors ('none') for an unfilled marker ('|').  Matplotlib is ignoring the edgecolor in favor of the facecolor.  This behavior may change in the future.
  ax.scatter(</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="combined_gf_grrr_reanalysis_files/figure-html/cell-53-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="447dc673-6953-4273-b264-50d7ce186618" class="cell" data-scrolled="true" data-execution_count="62">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>df_plot <span class="op">=</span> df_selected_trigger.copy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="b0769064-c64d-4ddc-b9f0-c1e56a0221c1" class="cell" data-execution_count="67">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>df_plot[<span class="st">"leadtime_5yr_target_days"</span>] <span class="op">=</span> df_plot[<span class="st">"leadtime_5yr_target"</span>].dt.days</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>df_plot[<span class="st">"leadtime_4yr_target_days"</span>] <span class="op">=</span> df_plot[<span class="st">"leadtime_4yr_target"</span>].dt.days</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>df_plot[<span class="st">"leadtime_3yr_target_days"</span>] <span class="op">=</span> df_plot[<span class="st">"leadtime_3yr_target"</span>].dt.days</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="88cb23a8-d26c-485c-9aec-2e1c6715852f" class="cell" data-scrolled="true" data-execution_count="68">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>df_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="68">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">dis24</th>
<th data-quarto-table-cell-role="th">SFED</th>
<th data-quarto-table-cell-role="th">streamflow</th>
<th data-quarto-table-cell-role="th">dis24_maxdate</th>
<th data-quarto-table-cell-role="th">SFED_maxdate</th>
<th data-quarto-table-cell-role="th">streamflow_maxdate</th>
<th data-quarto-table-cell-role="th">dis24_peak_leadtime</th>
<th data-quarto-table-cell-role="th">streamflow_peak_leadtime</th>
<th data-quarto-table-cell-role="th">dis24_rank</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">leadtime_3yr_target</th>
<th data-quarto-table-cell-role="th">leadtime_4yr_target</th>
<th data-quarto-table-cell-role="th">leadtime_5yr_target</th>
<th data-quarto-table-cell-role="th">rp_gf</th>
<th data-quarto-table-cell-role="th">rp_gr</th>
<th data-quarto-table-cell-role="th">dis24_5yr_leadtime</th>
<th data-quarto-table-cell-role="th">streamflow_5yr_leadtime</th>
<th data-quarto-table-cell-role="th">leadtime_5yr_target_days</th>
<th data-quarto-table-cell-role="th">leadtime_4yr_target_days</th>
<th data-quarto-table-cell-role="th">leadtime_3yr_target_days</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1998</td>
<td>4300.250000</td>
<td>0.142014</td>
<td>1328.853149</td>
<td>1998-09-03</td>
<td>1998-09-29</td>
<td>1998-10-06</td>
<td>26 days</td>
<td>-7 days</td>
<td>3</td>
<td>...</td>
<td>41 days</td>
<td>NaT</td>
<td>NaT</td>
<td>5.4</td>
<td>5.4</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>41.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1999</td>
<td>5244.656250</td>
<td>0.192214</td>
<td>1545.005493</td>
<td>1999-09-11</td>
<td>1999-10-21</td>
<td>1999-10-17</td>
<td>40 days</td>
<td>4 days</td>
<td>2</td>
<td>...</td>
<td>27 days</td>
<td>43 days</td>
<td>46 days</td>
<td>5.4</td>
<td>5.4</td>
<td>46 days</td>
<td>41 days</td>
<td>46.0</td>
<td>43.0</td>
<td>27.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2000</td>
<td>2863.234375</td>
<td>0.112231</td>
<td>762.573181</td>
<td>2000-09-07</td>
<td>2000-09-02</td>
<td>2000-10-06</td>
<td>-5 days</td>
<td>-34 days</td>
<td>8</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2001</td>
<td>2399.468750</td>
<td>0.061692</td>
<td>1064.437988</td>
<td>2001-09-20</td>
<td>2001-09-17</td>
<td>2001-10-04</td>
<td>-3 days</td>
<td>-17 days</td>
<td>13</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2002</td>
<td>1854.218750</td>
<td>0.093438</td>
<td>956.879333</td>
<td>2002-09-19</td>
<td>2002-09-24</td>
<td>2002-09-16</td>
<td>5 days</td>
<td>8 days</td>
<td>22</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2003</td>
<td>3312.015625</td>
<td>0.151862</td>
<td>953.153015</td>
<td>2003-09-19</td>
<td>2003-09-21</td>
<td>2003-09-30</td>
<td>2 days</td>
<td>-9 days</td>
<td>4</td>
<td>...</td>
<td>1 days</td>
<td>NaT</td>
<td>NaT</td>
<td>5.4</td>
<td>5.4</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2004</td>
<td>1856.578125</td>
<td>0.035491</td>
<td>801.753296</td>
<td>2004-09-07</td>
<td>2004-09-11</td>
<td>2004-09-26</td>
<td>4 days</td>
<td>-15 days</td>
<td>21</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2005</td>
<td>2077.328125</td>
<td>0.082421</td>
<td>903.818298</td>
<td>2005-08-15</td>
<td>2005-08-23</td>
<td>2005-10-07</td>
<td>8 days</td>
<td>-45 days</td>
<td>19</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>2006</td>
<td>1733.757812</td>
<td>0.113096</td>
<td>847.273560</td>
<td>2006-09-23</td>
<td>2006-09-16</td>
<td>2006-09-17</td>
<td>-7 days</td>
<td>-1 days</td>
<td>23</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>2007</td>
<td>2235.781250</td>
<td>0.103586</td>
<td>836.369751</td>
<td>2007-09-22</td>
<td>2007-09-12</td>
<td>2007-09-11</td>
<td>-10 days</td>
<td>1 days</td>
<td>17</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>2008</td>
<td>2627.976562</td>
<td>0.083352</td>
<td>1063.593872</td>
<td>2008-08-27</td>
<td>2008-06-28</td>
<td>2008-10-03</td>
<td>-60 days</td>
<td>-97 days</td>
<td>9</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>2009</td>
<td>2169.906250</td>
<td>0.103484</td>
<td>766.465027</td>
<td>2009-09-05</td>
<td>2009-09-08</td>
<td>2009-09-10</td>
<td>3 days</td>
<td>-2 days</td>
<td>18</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>2010</td>
<td>3109.257812</td>
<td>0.115183</td>
<td>1100.995361</td>
<td>2010-09-07</td>
<td>2010-09-10</td>
<td>2010-10-01</td>
<td>3 days</td>
<td>-21 days</td>
<td>6</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>2011</td>
<td>2461.625000</td>
<td>0.080652</td>
<td>778.979004</td>
<td>2011-09-14</td>
<td>2011-09-21</td>
<td>2011-10-18</td>
<td>7 days</td>
<td>-27 days</td>
<td>11</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>2012</td>
<td>3110.078125</td>
<td>0.286909</td>
<td>1394.855469</td>
<td>2012-08-21</td>
<td>2012-09-21</td>
<td>2012-09-23</td>
<td>31 days</td>
<td>-2 days</td>
<td>5</td>
<td>...</td>
<td>2 days</td>
<td>5 days</td>
<td>6 days</td>
<td>5.4</td>
<td>5.4</td>
<td>6 days</td>
<td>-6 days</td>
<td>6.0</td>
<td>5.0</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>2013</td>
<td>1611.937500</td>
<td>0.092912</td>
<td>775.987488</td>
<td>2013-08-28</td>
<td>2013-09-02</td>
<td>2013-09-07</td>
<td>5 days</td>
<td>-5 days</td>
<td>25</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>2014</td>
<td>2918.125000</td>
<td>0.100249</td>
<td>926.234802</td>
<td>2014-08-23</td>
<td>2014-08-31</td>
<td>2014-10-06</td>
<td>8 days</td>
<td>-36 days</td>
<td>7</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>2015</td>
<td>1563.804688</td>
<td>0.206910</td>
<td>738.006592</td>
<td>2015-09-20</td>
<td>2015-09-05</td>
<td>2015-10-12</td>
<td>-15 days</td>
<td>-37 days</td>
<td>26</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>2016</td>
<td>2364.773438</td>
<td>0.118837</td>
<td>969.453369</td>
<td>2016-09-22</td>
<td>2016-09-25</td>
<td>2016-10-09</td>
<td>3 days</td>
<td>-14 days</td>
<td>15</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>2017</td>
<td>1717.898438</td>
<td>0.088970</td>
<td>952.680115</td>
<td>2017-08-22</td>
<td>2017-08-19</td>
<td>2017-09-26</td>
<td>-3 days</td>
<td>-38 days</td>
<td>24</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>2018</td>
<td>2547.906250</td>
<td>0.165637</td>
<td>1157.043457</td>
<td>2018-09-28</td>
<td>2018-09-12</td>
<td>2018-09-16</td>
<td>-16 days</td>
<td>-4 days</td>
<td>10</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>2019</td>
<td>2440.054688</td>
<td>0.147553</td>
<td>1212.237061</td>
<td>2019-10-11</td>
<td>2019-10-30</td>
<td>2019-10-27</td>
<td>19 days</td>
<td>3 days</td>
<td>12</td>
<td>...</td>
<td>3 days</td>
<td>NaT</td>
<td>NaT</td>
<td>5.4</td>
<td>5.4</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>2020</td>
<td>1946.828125</td>
<td>0.087079</td>
<td>901.907959</td>
<td>2020-09-30</td>
<td>2020-10-05</td>
<td>2020-10-05</td>
<td>5 days</td>
<td>0 days</td>
<td>20</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>2021</td>
<td>2253.296875</td>
<td>0.134848</td>
<td>676.297546</td>
<td>2021-07-09</td>
<td>2021-08-29</td>
<td>2021-09-05</td>
<td>51 days</td>
<td>-7 days</td>
<td>16</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>2022</td>
<td>5347.171875</td>
<td>0.269161</td>
<td>1793.780396</td>
<td>2022-08-19</td>
<td>2022-09-21</td>
<td>2022-09-24</td>
<td>33 days</td>
<td>-3 days</td>
<td>1</td>
<td>...</td>
<td>8 days</td>
<td>10 days</td>
<td>22 days</td>
<td>5.4</td>
<td>5.4</td>
<td>22 days</td>
<td>6 days</td>
<td>22.0</td>
<td>10.0</td>
<td>8.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>2023</td>
<td>2379.328125</td>
<td>0.203958</td>
<td>900.323486</td>
<td>2023-08-26</td>
<td>2023-10-09</td>
<td>2023-10-07</td>
<td>44 days</td>
<td>2 days</td>
<td>14</td>
<td>...</td>
<td>NaT</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaT</td>
<td>NaT</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>26 rows × 35 columns</p>
</div>
</div>
</div>
<p>Have a look at how the leadtime varies with flood severity - doesn’t seem to be much of a relationship.</p>
<div id="1116f111-f831-4de8-bbb7-2359c273bce1" class="cell" data-execution_count="71">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>df_plot.plot(x<span class="op">=</span><span class="st">"SFED"</span>, y<span class="op">=</span><span class="st">"leadtime_3yr_target_days"</span>, marker<span class="op">=</span><span class="st">"."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="combined_gf_grrr_reanalysis_files/figure-html/cell-57-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script>
document.addEventListener('DOMContentLoaded', () => {
  // For each code cell, group all output nodes into a single wrapper
  // Quarto uses several output classes; target them all
  const OUTPUT_SELECTOR =
    '.cell-output, .cell-output-display, .cell-output-stdout, .cell-output-stderr, .cell-output-error';

  document.querySelectorAll('.cell').forEach(cell => {
    // Collect direct (or nested) output nodes within the cell
    const outs = cell.querySelectorAll(OUTPUT_SELECTOR);
    if (!outs.length) return;

    // Skip if we've already wrapped this cell
    if (cell.querySelector(':scope > .q-output-wrapper')) return;

    // Create a wrapper and insert it before the first output
    const wrapper = document.createElement('div');
    wrapper.className = 'q-output-wrapper';

    const firstOut = outs[0];
    firstOut.parentNode.insertBefore(wrapper, firstOut);

    // Move all outputs into the wrapper (preserves order)
    outs.forEach(out => wrapper.appendChild(out));
  });
});
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button,
        { trigger: "manual",
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config);
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined;
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            }
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          }
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../exploration/2025/floodscan_verify.html" class="pagination-link" aria-label="Verifying Floodscan data with NiHSA observations">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Verifying Floodscan data with NiHSA observations</span></span>
      </a>
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../exploration/2025/gf_reforecast.html" class="pagination-link" aria-label="GloFAS reforecast threshold check">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">GloFAS reforecast threshold check</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>
